import{_ as s,V as n,W as a,a1 as e}from"./framework-5e2051d8.js";const p={},t=e(`<h1 id="mysql语句练习" tabindex="-1"><a class="header-anchor" href="#mysql语句练习" aria-hidden="true">#</a> MySQl语句练习</h1><h3 id="使用数据库" tabindex="-1"><a class="header-anchor" href="#使用数据库" aria-hidden="true">#</a> 使用数据库</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">show</span> <span class="token keyword">databases</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> atguigudb<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="重置密码" tabindex="-1"><a class="header-anchor" href="#重置密码" aria-hidden="true">#</a> 重置密码</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">use</span> mysql<span class="token punctuation">;</span>
<span class="token keyword">ALTER</span> <span class="token keyword">USER</span> <span class="token string">&#39;root&#39;</span><span class="token variable">@&#39;localhost&#39;</span> IDENTIFIED <span class="token keyword">BY</span> <span class="token string">&#39;123456&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">show</span> <span class="token keyword">tables</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span><span class="token punctuation">,</span> first_name <span class="token keyword">as</span> f_name<span class="token punctuation">,</span> last_name <span class="token keyword">as</span> l_name
<span class="token keyword">from</span> employees<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token keyword">distinct</span> department_id
<span class="token keyword">from</span> employees<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 计算年工资</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> employee_id<span class="token punctuation">,</span> salary <span class="token string">&quot;月工资&quot;</span><span class="token punctuation">,</span> salary <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> IFNULL<span class="token punctuation">(</span>commission_pct<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">12</span> <span class="token string">&quot;年工资&quot;</span><span class="token punctuation">,</span> commission_pct
<span class="token keyword">from</span> employees<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token identifier"><span class="token punctuation">\`</span>order<span class="token punctuation">\`</span></span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>-- 查询常量</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span><span class="token punctuation">,</span> <span class="token string">&#39;hello&#39;</span>
<span class="token keyword">from</span> <span class="token identifier"><span class="token punctuation">\`</span>order<span class="token punctuation">\`</span></span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 显示表结构</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">describe</span> employees<span class="token punctuation">;</span>
<span class="token keyword">DESC</span> <span class="token identifier"><span class="token punctuation">\`</span>employees<span class="token punctuation">\`</span></span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 去重</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token keyword">distinct</span> job_id
<span class="token keyword">from</span> <span class="token identifier"><span class="token punctuation">\`</span>employees<span class="token punctuation">\`</span></span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>-- where</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> employees<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> last_name <span class="token operator">=</span> <span class="token string">&#39;king&#39;</span>
  <span class="token operator">and</span> first_name <span class="token operator">=</span> <span class="token string">&#39;Steven&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="练习" tabindex="-1"><a class="header-anchor" href="#练习" aria-hidden="true">#</a> 练习</h3><p>-- 计算12个月的总工资</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span><span class="token punctuation">,</span> salary <span class="token operator">*</span> <span class="token number">12</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> IFNULL<span class="token punctuation">(</span>commission_pct<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token string">&quot;12月基本工资&quot;</span>
<span class="token keyword">from</span> employees<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 去除重复job_id</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token keyword">distinct</span> job_id
<span class="token keyword">from</span> employees<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 查询工资大于12000 的员工的工资和姓名</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> salary <span class="token operator">&gt;</span> <span class="token number">12000</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 查询工号为167的员工的姓名和部门号</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> first_name<span class="token punctuation">,</span> last_name<span class="token punctuation">,</span> department_id
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> employee_id <span class="token operator">=</span> <span class="token number">167</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 显示departments的表结构,并查询全部数据</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">desc</span> departments<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> departments<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="运算符" tabindex="-1"><a class="header-anchor" href="#运算符" aria-hidden="true">#</a> 运算符</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token operator">*</span> <span class="token number">5</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token operator">*</span> <span class="token number">5</span>
<span class="token keyword">from</span> dual<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> department_id <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token number">1</span> <span class="token operator">&lt;=&gt;</span> <span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span> <span class="token operator">&lt;=&gt;</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token number">1</span> <span class="token operator">=</span> <span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span> <span class="token operator">=</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 最小 /最大</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> LEAST<span class="token punctuation">(</span>first_name<span class="token punctuation">,</span> last_name<span class="token punctuation">)</span>
<span class="token keyword">from</span> employees<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 范围查询</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> salary <span class="token operator">&gt;=</span> <span class="token number">6000</span> <span class="token operator">&amp;&amp;</span> salary <span class="token operator">&lt;=</span> <span class="token number">8000</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> salary<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 模糊查询</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> first_name
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> first_name <span class="token operator">like</span> <span class="token string">&#39;%ab%&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> first_name
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> first_name <span class="token operator">like</span> <span class="token string">&#39;%a%e%&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> last_name
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> last_name <span class="token operator">like</span> <span class="token string">&#39;%a%&#39;</span>
  <span class="token operator">and</span> last_name <span class="token operator">like</span> <span class="token string">&#39;%e%&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- _ 代表一个字符 -- 查询第二个字符是a的last_name</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> first_name
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> first_name <span class="token operator">like</span> <span class="token string">&#39;_a%&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 查询第三个字符是c的last_name</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> first_name
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> first_name <span class="token operator">like</span> <span class="token string">&#39;__c%&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 转义字符,查询第二个字符是_,第三个字符是o</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> last_name
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> last_name <span class="token operator">like</span> <span class="token string">&#39;_\\_o%&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- in(set) / not in(set)</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> salary <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">12000</span><span class="token punctuation">,</span> <span class="token number">13000</span><span class="token punctuation">,</span> <span class="token number">14000</span><span class="token punctuation">)</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> salary<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> salary <span class="token operator">not</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">12000</span><span class="token punctuation">,</span> <span class="token number">13000</span><span class="token punctuation">,</span> <span class="token number">14000</span><span class="token punctuation">)</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> salary<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="运算符-1" tabindex="-1"><a class="header-anchor" href="#运算符-1" aria-hidden="true">#</a> 运算符</h3><h3 id="运算符练习" tabindex="-1"><a class="header-anchor" href="#运算符练习" aria-hidden="true">#</a> 运算符练习</h3><p>-- 1. 选择工资不在5000到12000的员工的姓名和工资</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> first_name<span class="token punctuation">,</span> salary
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> <span class="token operator">not</span> <span class="token punctuation">(</span>salary <span class="token operator">&gt;</span> <span class="token number">5000</span> <span class="token operator">and</span> salary <span class="token operator">&lt;</span> <span class="token number">12000</span><span class="token punctuation">)</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> salary <span class="token keyword">desc</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 2 查询 20号或者50号部门工作的员工,姓名和部门号</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> first_name<span class="token punctuation">,</span> department_id
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> department_id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 3 选择公司中没有管理者的员工的姓名和job_id</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> job_id<span class="token punctuation">,</span> first_name<span class="token punctuation">,</span> department_id
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> department_id <span class="token operator">&lt;=&gt;</span> <span class="token boolean">null</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 4. 选择公司中有奖金的员工姓名,工资和奖金级别</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> last_name<span class="token punctuation">,</span> salary<span class="token punctuation">,</span> commission_pct
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> <span class="token operator">not</span> commission_pct <span class="token operator">&lt;=&gt;</span> <span class="token boolean">null</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> last_name<span class="token punctuation">,</span> salary<span class="token punctuation">,</span> commission_pct
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> commission_pct <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 5. 查询员工姓名第三个字母是a的员工</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> last_name <span class="token operator">like</span> <span class="token string">&#39;__a%&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 6. 查询员工姓名中有字母a和k的员工的姓名</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> last_name
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> last_name <span class="token operator">like</span> <span class="token string">&#39;%a%k%&#39;</span>
   <span class="token operator">or</span> last_name <span class="token operator">like</span> <span class="token string">&#39;%k%a%&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> last_name
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> last_name <span class="token operator">like</span> <span class="token string">&#39;%a%&#39;</span>
  <span class="token operator">and</span> last_name <span class="token operator">like</span> <span class="token string">&#39;%k%&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 7 查询表employees first_name 以e结尾的员工信息</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> first_name
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> first_name <span class="token operator">like</span> <span class="token string">&#39;%e&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 8 查询表employees 部门编号在80-100之间的姓名和工种</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> department_id<span class="token punctuation">,</span> last_name<span class="token punctuation">,</span> job_id
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> department_id <span class="token operator">&gt;=</span> <span class="token number">80</span>
  <span class="token operator">and</span> department_id <span class="token operator">&lt;=</span> <span class="token number">100</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> department_id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 9. 查询表employees中manger_id是100,101,110的员工的姓名,工资,管理者id</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> last_name<span class="token punctuation">,</span> salary<span class="token punctuation">,</span> manager_id
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> manager_id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="运算符练习-1" tabindex="-1"><a class="header-anchor" href="#运算符练习-1" aria-hidden="true">#</a> 运算符练习</h3><h3 id="排序和分页" tabindex="-1"><a class="header-anchor" href="#排序和分页" aria-hidden="true">#</a> 排序和分页</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> employees
<span class="token keyword">order</span> <span class="token keyword">by</span> employee_id<span class="token punctuation">,</span> department_id <span class="token keyword">desc</span><span class="token punctuation">;</span>
<span class="token comment">--  limit (pageNo-1)*pageSize ,pageSize</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> employees
<span class="token keyword">order</span> <span class="token keyword">by</span> employee_id<span class="token punctuation">,</span> department_id <span class="token keyword">desc</span>
<span class="token keyword">limit</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">;</span>

<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> employee_id <span class="token operator">&gt;</span> <span class="token number">110</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> employee_id <span class="token keyword">desc</span>
<span class="token keyword">limit</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 查询第100 ,101条数据</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> employees
<span class="token keyword">limit</span> <span class="token number">99</span> <span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 查询工资最高的员工</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> employees
<span class="token keyword">order</span> <span class="token keyword">by</span> salary <span class="token keyword">desc</span>
<span class="token keyword">limit</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="排序和分页-1" tabindex="-1"><a class="header-anchor" href="#排序和分页-1" aria-hidden="true">#</a> 排序和分页</h3><h3 id="练习-1" tabindex="-1"><a class="header-anchor" href="#练习-1" aria-hidden="true">#</a> 练习</h3><p>-- 1. 查询员工的姓名部门你年薪,按照年薪降序,姓名升序</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> salary <span class="token operator">*</span> <span class="token number">12</span> <span class="token keyword">as</span> y_salary<span class="token punctuation">,</span> last_name
<span class="token keyword">from</span> employees
<span class="token keyword">order</span> <span class="token keyword">by</span> y_salary <span class="token keyword">desc</span><span class="token punctuation">,</span> last_name <span class="token keyword">asc</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 2. 查询工资不在8000 到17000 的员工,按照工资降序,显示21 到40位置的数据</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> <span class="token operator">not</span> salary <span class="token operator">&gt;</span> <span class="token number">8000</span>
  <span class="token operator">and</span> salary <span class="token operator">&lt;</span> <span class="token number">17000</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> salary <span class="token keyword">desc</span><span class="token punctuation">,</span> last_name <span class="token keyword">asc</span>
<span class="token keyword">limit</span> <span class="token number">20</span> <span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 3. 查询邮箱中包含e的员工,并且按照邮箱的字节数降序,再按照部门号升序</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> email<span class="token punctuation">,</span> department_id
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> email <span class="token operator">like</span> <span class="token string">&#39;%e%&#39;</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> length<span class="token punctuation">(</span>email<span class="token punctuation">)</span> <span class="token keyword">desc</span><span class="token punctuation">,</span> department_id <span class="token keyword">asc</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="练习-2" tabindex="-1"><a class="header-anchor" href="#练习-2" aria-hidden="true">#</a> 练习</h3><h3 id="多表查询" tabindex="-1"><a class="header-anchor" href="#多表查询" aria-hidden="true">#</a> 多表查询</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> employees<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> departments<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> locations<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> last_name <span class="token operator">=</span> <span class="token string">&#39;Abel&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> departments
<span class="token keyword">where</span> department_id <span class="token operator">=</span> <span class="token number">80</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> locations
<span class="token keyword">where</span> location_id <span class="token operator">=</span> <span class="token number">2500</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 联合查询</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> employee_id<span class="token punctuation">,</span> department_name<span class="token punctuation">,</span> departments<span class="token punctuation">.</span>department_id
<span class="token keyword">from</span> employees
         <span class="token keyword">join</span> departments
<span class="token keyword">where</span> employees<span class="token punctuation">.</span>department_id <span class="token operator">=</span> departments<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 表的别名</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> e<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span> d<span class="token punctuation">.</span>department_name<span class="token punctuation">,</span> e<span class="token punctuation">.</span>department_id
<span class="token keyword">from</span> employees <span class="token keyword">as</span> e
         <span class="token keyword">join</span> departments <span class="token keyword">as</span> d
<span class="token keyword">where</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 练习 -- 1. 查询员工的employee_id,last_name,department_name,city</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> e<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> d<span class="token punctuation">.</span>department_name<span class="token punctuation">,</span> l<span class="token punctuation">.</span>city
<span class="token keyword">from</span> employees <span class="token keyword">as</span> e<span class="token punctuation">,</span>
     departments <span class="token keyword">as</span> d<span class="token punctuation">,</span>
     locations <span class="token keyword">as</span> l
<span class="token keyword">where</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id
  <span class="token operator">and</span> d<span class="token punctuation">.</span>location_id <span class="token operator">=</span> l<span class="token punctuation">.</span>location_id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 非等值连接</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> job_grades<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 查询员工的工资和对应的等级</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> e<span class="token punctuation">.</span>salary<span class="token punctuation">,</span> j<span class="token punctuation">.</span>grade_level
<span class="token keyword">from</span> employees <span class="token keyword">as</span> e<span class="token punctuation">,</span>
     job_grades <span class="token keyword">as</span> j
<span class="token keyword">where</span> e<span class="token punctuation">.</span>salary <span class="token operator">between</span> j<span class="token punctuation">.</span>lowest_sal <span class="token operator">and</span> j<span class="token punctuation">.</span>highest_sal
<span class="token keyword">order</span> <span class="token keyword">by</span> grade_level<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 自连接 -- 练习: 查询员工id,员工姓名及管理者的id和姓名</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> t1<span class="token punctuation">.</span>employee_id <span class="token keyword">as</span> <span class="token string">&#39;员工id&#39;</span><span class="token punctuation">,</span> t1<span class="token punctuation">.</span>last_name <span class="token keyword">as</span> <span class="token string">&#39;员工姓名&#39;</span><span class="token punctuation">,</span> t2<span class="token punctuation">.</span>employee_id <span class="token keyword">as</span> <span class="token string">&#39;管理者id&#39;</span><span class="token punctuation">,</span> t2<span class="token punctuation">.</span>last_name <span class="token keyword">as</span> <span class="token string">&#39;管理者姓名&#39;</span>
<span class="token keyword">from</span> employees <span class="token keyword">as</span> t1<span class="token punctuation">,</span>
     employees <span class="token keyword">as</span> t2
<span class="token keyword">where</span> t1<span class="token punctuation">.</span>manager_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>employee_id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 内连接和外连接 -- 内连接 相当于交集 -- 外连接相当于并集 -- 外连接分:左外,右外 ,满外</p><p>-- 练习: 查询所有的员工的last_name,department_name信息,</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> d<span class="token punctuation">.</span>department_name
<span class="token keyword">from</span> employees <span class="token keyword">as</span> e<span class="token punctuation">,</span>
     departments <span class="token keyword">as</span> d
<span class="token keyword">where</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 99 语法</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> d<span class="token punctuation">.</span>department_name
<span class="token keyword">from</span> employees <span class="token keyword">as</span> e
         <span class="token keyword">join</span> departments <span class="token keyword">as</span> d
              <span class="token keyword">on</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 内连接</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> e<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> d<span class="token punctuation">.</span>department_name<span class="token punctuation">,</span> l<span class="token punctuation">.</span>city
<span class="token keyword">from</span> employees <span class="token keyword">as</span> e
         <span class="token keyword">join</span> departments <span class="token keyword">as</span> d
              <span class="token keyword">on</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id
         <span class="token keyword">join</span> locations <span class="token keyword">as</span> l
              <span class="token keyword">on</span> d<span class="token punctuation">.</span>location_id <span class="token operator">=</span> l<span class="token punctuation">.</span>location_id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 左外连接</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> e<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> d<span class="token punctuation">.</span>department_name<span class="token punctuation">,</span> l<span class="token punctuation">.</span>city
<span class="token keyword">from</span> employees <span class="token keyword">as</span> e
         <span class="token keyword">left</span> <span class="token keyword">outer</span> <span class="token keyword">join</span> departments <span class="token keyword">as</span> d
                         <span class="token keyword">on</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id
         <span class="token keyword">left</span> <span class="token keyword">outer</span> <span class="token keyword">join</span> locations <span class="token keyword">as</span> l
                         <span class="token keyword">on</span> d<span class="token punctuation">.</span>location_id <span class="token operator">=</span> l<span class="token punctuation">.</span>location_id
<span class="token keyword">order</span> <span class="token keyword">by</span> e<span class="token punctuation">.</span>employee_id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 右外连接 outer inner 可以省略</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> e<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> d<span class="token punctuation">.</span>department_name<span class="token punctuation">,</span> l<span class="token punctuation">.</span>city
<span class="token keyword">from</span> employees <span class="token keyword">as</span> e
         <span class="token keyword">right</span> <span class="token keyword">outer</span> <span class="token keyword">join</span> departments <span class="token keyword">as</span> d
                          <span class="token keyword">on</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id
         <span class="token keyword">join</span> locations <span class="token keyword">as</span> l
              <span class="token keyword">on</span> d<span class="token punctuation">.</span>location_id <span class="token operator">=</span> l<span class="token punctuation">.</span>location_id
<span class="token keyword">order</span> <span class="token keyword">by</span> e<span class="token punctuation">.</span>employee_id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="union-和-union-all-联合查询" tabindex="-1"><a class="header-anchor" href="#union-和-union-all-联合查询" aria-hidden="true">#</a> union 和 union all 联合查询</h3><h3 id="_7中join-实现" tabindex="-1"><a class="header-anchor" href="#_7中join-实现" aria-hidden="true">#</a> 7中join 实现</h3><p>-- 内连接</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> last_name<span class="token punctuation">,</span> department_name
<span class="token keyword">from</span> employees <span class="token keyword">as</span> t1<span class="token punctuation">,</span>
     departments <span class="token keyword">as</span> t2
<span class="token keyword">where</span> t1<span class="token punctuation">.</span>department_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 左外连接</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> last_name<span class="token punctuation">,</span> department_name
<span class="token keyword">from</span> employees <span class="token keyword">as</span> t1
         <span class="token keyword">left</span> <span class="token keyword">join</span> departments <span class="token keyword">as</span> t2
                   <span class="token keyword">on</span> t1<span class="token punctuation">.</span>department_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 右外连接</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> last_name<span class="token punctuation">,</span> department_name
<span class="token keyword">from</span> employees <span class="token keyword">as</span> t1
         <span class="token keyword">right</span> <span class="token keyword">join</span> departments <span class="token keyword">as</span> t2
                    <span class="token keyword">on</span> t1<span class="token punctuation">.</span>department_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 左外连接 去掉交集</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> last_name<span class="token punctuation">,</span> department_name
<span class="token keyword">from</span> employees <span class="token keyword">as</span> t1
         <span class="token keyword">left</span> <span class="token keyword">join</span> departments <span class="token keyword">as</span> t2
                   <span class="token keyword">on</span> t1<span class="token punctuation">.</span>department_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>department_id
<span class="token keyword">where</span> t2<span class="token punctuation">.</span>department_id <span class="token operator">&lt;=&gt;</span> <span class="token boolean">null</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 右外连接 去掉交集</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> t1<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> t2<span class="token punctuation">.</span>department_name<span class="token punctuation">,</span> t2<span class="token punctuation">.</span>department_id
<span class="token keyword">from</span> employees <span class="token keyword">as</span> t1
         <span class="token keyword">right</span> <span class="token keyword">join</span> departments <span class="token keyword">as</span> t2
                    <span class="token keyword">on</span> t1<span class="token punctuation">.</span>department_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>department_id
<span class="token keyword">where</span> t1<span class="token punctuation">.</span>department_id <span class="token operator">&lt;=&gt;</span> <span class="token boolean">null</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 满外连接</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> last_name<span class="token punctuation">,</span> department_name<span class="token punctuation">,</span> t2<span class="token punctuation">.</span>department_id
<span class="token keyword">from</span> employees <span class="token keyword">as</span> t1
         <span class="token keyword">left</span> <span class="token keyword">join</span> departments <span class="token keyword">as</span> t2
                   <span class="token keyword">on</span> t1<span class="token punctuation">.</span>department_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>department_id
<span class="token keyword">union</span> <span class="token keyword">all</span>
<span class="token keyword">select</span> t1<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> t2<span class="token punctuation">.</span>department_name<span class="token punctuation">,</span> t2<span class="token punctuation">.</span>department_id
<span class="token keyword">from</span> employees <span class="token keyword">as</span> t1
         <span class="token keyword">right</span> <span class="token keyword">join</span> departments <span class="token keyword">as</span> t2
                    <span class="token keyword">on</span> t1<span class="token punctuation">.</span>department_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>department_id
<span class="token keyword">where</span> t1<span class="token punctuation">.</span>department_id <span class="token operator">&lt;=&gt;</span> <span class="token boolean">null</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 去除交集对应sql joins 的右下图</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> t1<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> t2<span class="token punctuation">.</span>department_name<span class="token punctuation">,</span> t2<span class="token punctuation">.</span>department_id
<span class="token keyword">from</span> employees <span class="token keyword">as</span> t1
         <span class="token keyword">left</span> <span class="token keyword">join</span> departments <span class="token keyword">as</span> t2
                   <span class="token keyword">on</span> t1<span class="token punctuation">.</span>department_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>department_id
<span class="token keyword">where</span> t2<span class="token punctuation">.</span>department_id <span class="token operator">&lt;=&gt;</span> <span class="token boolean">null</span>
<span class="token keyword">union</span> <span class="token keyword">all</span>
<span class="token keyword">select</span> t1<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> t2<span class="token punctuation">.</span>department_name<span class="token punctuation">,</span> t2<span class="token punctuation">.</span>department_id
<span class="token keyword">from</span> employees <span class="token keyword">as</span> t1
         <span class="token keyword">right</span> <span class="token keyword">join</span> departments <span class="token keyword">as</span> t2
                    <span class="token keyword">on</span> t1<span class="token punctuation">.</span>department_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>department_id
<span class="token keyword">where</span> t1<span class="token punctuation">.</span>department_id <span class="token operator">&lt;=&gt;</span> <span class="token boolean">null</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="自然连接" tabindex="-1"><a class="header-anchor" href="#自然连接" aria-hidden="true">#</a> 自然连接</h3><p>-- 原有方式</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> e<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> d<span class="token punctuation">.</span>department_name
<span class="token keyword">from</span> employees <span class="token keyword">as</span> e
         <span class="token keyword">join</span> departments <span class="token keyword">as</span> d
              <span class="token keyword">on</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id
                  <span class="token operator">and</span> e<span class="token punctuation">.</span>manager_id <span class="token operator">=</span> d<span class="token punctuation">.</span>manager_id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 99新特性 自然连接 自动查询两个/多个表中相同的字段</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> e<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> d<span class="token punctuation">.</span>department_name
<span class="token keyword">from</span> employees <span class="token keyword">as</span> e
         <span class="token keyword">natural</span> <span class="token keyword">join</span> departments <span class="token keyword">as</span> d<span class="token punctuation">;</span>

<span class="token keyword">select</span> e<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> d<span class="token punctuation">.</span>department_name<span class="token punctuation">,</span> l<span class="token punctuation">.</span>city
<span class="token keyword">from</span> employees <span class="token keyword">as</span> e
         <span class="token keyword">natural</span> <span class="token keyword">join</span> departments <span class="token keyword">as</span> d
         <span class="token keyword">natural</span> <span class="token keyword">join</span> locations <span class="token keyword">as</span> l<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="练习-3" tabindex="-1"><a class="header-anchor" href="#练习-3" aria-hidden="true">#</a> 练习</h3><p>-- 1. 显示&#39;所有&#39;的员工的姓名,部门号和部门名称</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> last_name<span class="token punctuation">,</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">,</span> d<span class="token punctuation">.</span>department_name
<span class="token keyword">from</span> employees <span class="token keyword">as</span> e
         <span class="token keyword">left</span> <span class="token keyword">join</span> departments <span class="token keyword">as</span> d
                   <span class="token keyword">on</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 2. 查询90号部门员工的job_id 和90号部门的location_id</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> e<span class="token punctuation">.</span>job_id<span class="token punctuation">,</span> e<span class="token punctuation">.</span>department_id<span class="token punctuation">,</span> d<span class="token punctuation">.</span>location_id
<span class="token keyword">from</span> employees <span class="token keyword">as</span> e<span class="token punctuation">,</span>
     departments <span class="token keyword">as</span> d
<span class="token keyword">where</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> <span class="token number">90</span>
  <span class="token operator">and</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 3. 查询&#39;所有&#39;有奖金的员工的last_name,department_name,location_id,city</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> e<span class="token punctuation">.</span>commission_pct<span class="token punctuation">,</span> d<span class="token punctuation">.</span>department_name<span class="token punctuation">,</span> l<span class="token punctuation">.</span>location_id<span class="token punctuation">,</span> l<span class="token punctuation">.</span>city
<span class="token keyword">from</span> employees <span class="token keyword">as</span> e
         <span class="token keyword">left</span> <span class="token keyword">join</span> departments <span class="token keyword">as</span> d
                   <span class="token keyword">on</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id
         <span class="token keyword">left</span> <span class="token keyword">join</span> locations <span class="token keyword">as</span> l
                   <span class="token keyword">on</span> d<span class="token punctuation">.</span>location_id <span class="token operator">=</span> l<span class="token punctuation">.</span>location_id
<span class="token keyword">where</span> e<span class="token punctuation">.</span>commission_pct <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 4. 选择city在Toronto工作的员工的last_name,job_id, department_id,department_name</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> e<span class="token punctuation">.</span>job_id<span class="token punctuation">,</span> d<span class="token punctuation">.</span>department_name<span class="token punctuation">,</span> e<span class="token punctuation">.</span>department_id<span class="token punctuation">,</span> l<span class="token punctuation">.</span>location_id<span class="token punctuation">,</span> l<span class="token punctuation">.</span>city
<span class="token keyword">from</span> employees <span class="token keyword">as</span> e<span class="token punctuation">,</span>
     departments <span class="token keyword">as</span> d<span class="token punctuation">,</span>
     locations <span class="token keyword">as</span> l
<span class="token keyword">where</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id
  <span class="token operator">and</span> d<span class="token punctuation">.</span>location_id <span class="token operator">=</span> l<span class="token punctuation">.</span>location_id
  <span class="token operator">and</span> l<span class="token punctuation">.</span>city <span class="token operator">=</span> <span class="token string">&#39;Toronto&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 5. 查询员工所在的部门名称,部门地址,姓名,工作,工资,其中员工所在部门的部门名称为&#39;Executive&#39;</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> d<span class="token punctuation">.</span>department_name<span class="token punctuation">,</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> e<span class="token punctuation">.</span>job_id<span class="token punctuation">,</span> e<span class="token punctuation">.</span>salary<span class="token punctuation">,</span> l<span class="token punctuation">.</span>street_address
<span class="token keyword">from</span> employees <span class="token keyword">as</span> e
         <span class="token keyword">left</span> <span class="token keyword">join</span> departments <span class="token keyword">as</span> d
                   <span class="token keyword">on</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id
         <span class="token keyword">left</span> <span class="token keyword">join</span> locations <span class="token keyword">as</span> l
                   <span class="token keyword">on</span> d<span class="token punctuation">.</span>location_id <span class="token operator">=</span> l<span class="token punctuation">.</span>location_id
<span class="token keyword">where</span> d<span class="token punctuation">.</span>department_name <span class="token operator">=</span> <span class="token string">&#39;Executive&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 6. 查询指定员工的姓名,员工号,以及他他他的管理者的姓名员工号(需要起别名)</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> t1<span class="token punctuation">.</span>last_name <span class="token keyword">as</span> <span class="token string">&#39;姓名&#39;</span><span class="token punctuation">,</span> t1<span class="token punctuation">.</span>employee_id <span class="token keyword">as</span> <span class="token string">&#39;员工号&#39;</span><span class="token punctuation">,</span> t2<span class="token punctuation">.</span>last_name <span class="token keyword">as</span> <span class="token string">&#39;管理者&#39;</span><span class="token punctuation">,</span> t2<span class="token punctuation">.</span>employee_id <span class="token keyword">as</span> <span class="token string">&#39;管理者员工号&#39;</span>
<span class="token keyword">from</span> employees <span class="token keyword">as</span> t1
         <span class="token keyword">left</span> <span class="token keyword">join</span> employees <span class="token keyword">as</span> t2
                   <span class="token keyword">on</span> t1<span class="token punctuation">.</span>manager_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>employee_id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 7. 查询哪些部门没有员工</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> departments <span class="token keyword">as</span> d
         <span class="token keyword">left</span> <span class="token keyword">join</span> employees <span class="token keyword">as</span> e
                   <span class="token keyword">on</span> d<span class="token punctuation">.</span>department_id <span class="token operator">=</span> e<span class="token punctuation">.</span>department_id
<span class="token keyword">where</span> e<span class="token punctuation">.</span>department_id <span class="token operator">is</span> <span class="token boolean">null</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 8. 查询哪些城市没有部门</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> l<span class="token punctuation">.</span>city<span class="token punctuation">,</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">,</span> d<span class="token punctuation">.</span>department_name
<span class="token keyword">from</span> locations <span class="token keyword">as</span> l
         <span class="token keyword">left</span> <span class="token keyword">join</span> departments <span class="token keyword">as</span> d
                   <span class="token keyword">on</span> l<span class="token punctuation">.</span>location_id <span class="token operator">=</span> d<span class="token punctuation">.</span>location_id
<span class="token keyword">where</span> d<span class="token punctuation">.</span>department_id <span class="token operator">is</span> <span class="token boolean">null</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 9. 查询部门名为Sales 或 IT的员工信息</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> employees <span class="token keyword">as</span> e<span class="token punctuation">,</span>
     departments <span class="token keyword">as</span> d
<span class="token keyword">where</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id
  <span class="token operator">and</span> d<span class="token punctuation">.</span>department_name <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token string">&#39;Sales&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;IT&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="练习-4" tabindex="-1"><a class="header-anchor" href="#练习-4" aria-hidden="true">#</a> 练习</h3><h3 id="单行函数" tabindex="-1"><a class="header-anchor" href="#单行函数" aria-hidden="true">#</a> 单行函数</h3><h3 id="字符串函数" tabindex="-1"><a class="header-anchor" href="#字符串函数" aria-hidden="true">#</a> 字符串函数</h3><h3 id="日期函数" tabindex="-1"><a class="header-anchor" href="#日期函数" aria-hidden="true">#</a> 日期函数</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> unix_timestamp<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> from_unixtime<span class="token punctuation">(</span>unix_timestamp<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="流程控制函数" tabindex="-1"><a class="header-anchor" href="#流程控制函数" aria-hidden="true">#</a> 流程控制函数</h3><p>-- if</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> last_name<span class="token punctuation">,</span> salary<span class="token punctuation">,</span> <span class="token keyword">if</span><span class="token punctuation">(</span>salary <span class="token operator">&gt;</span> <span class="token number">6000</span><span class="token punctuation">,</span> <span class="token string">&#39;高工资&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;低工资&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token string">&#39;工资水平&#39;</span>
<span class="token keyword">from</span> employees
<span class="token keyword">order</span> <span class="token keyword">by</span> salary<span class="token punctuation">;</span>

<span class="token keyword">select</span> last_name<span class="token punctuation">,</span> <span class="token keyword">if</span><span class="token punctuation">(</span>commission_pct <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span> commission_pct<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token string">&quot;奖金&quot;</span>
<span class="token keyword">from</span> employees
<span class="token keyword">order</span> <span class="token keyword">by</span> commission_pct<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- ifnull</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> last_name<span class="token punctuation">,</span> ifnull<span class="token punctuation">(</span>commission_pct<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token string">&quot;奖金&quot;</span>
<span class="token keyword">from</span> employees
<span class="token keyword">order</span> <span class="token keyword">by</span> commission_pct<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- case when then else end</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> last_name<span class="token punctuation">,</span>
       salary<span class="token punctuation">,</span>
       <span class="token keyword">case</span>
           <span class="token keyword">when</span> salary <span class="token operator">&gt;</span> <span class="token number">15000</span> <span class="token keyword">then</span> <span class="token string">&#39;白骨精&#39;</span>
           <span class="token keyword">when</span> salary <span class="token operator">&gt;</span> <span class="token number">10000</span> <span class="token keyword">then</span> <span class="token string">&#39;潜力股&#39;</span>
           <span class="token keyword">when</span> salary <span class="token operator">&gt;</span> <span class="token number">20000</span> <span class="token keyword">then</span> <span class="token string">&#39;潜力股&#39;</span>
           <span class="token keyword">else</span> <span class="token string">&#39;前途无限&#39;</span>
           <span class="token keyword">end</span> <span class="token keyword">as</span> <span class="token string">&quot;段位&quot;</span>
<span class="token keyword">from</span> employees
<span class="token keyword">order</span> <span class="token keyword">by</span> salary<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="练习-5" tabindex="-1"><a class="header-anchor" href="#练习-5" aria-hidden="true">#</a> 练习</h4><p>1 .查询部门号为10,20,30 的员工信息 , 若部门号为 10 ,咋打印其工资的1.1倍, 20号工资1.2倍,30号 1.3倍,其他部门为1.4倍</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> last_name<span class="token punctuation">,</span>
       department_id<span class="token punctuation">,</span>
       salary  <span class="token keyword">as</span> <span class="token string">&#39;基本工资&#39;</span><span class="token punctuation">,</span>
       <span class="token keyword">case</span> department_id
           <span class="token keyword">when</span> <span class="token number">10</span> <span class="token keyword">then</span> salary <span class="token operator">*</span> <span class="token number">1.1</span>
           <span class="token keyword">when</span> <span class="token number">20</span> <span class="token keyword">then</span> salary <span class="token operator">*</span> <span class="token number">1.2</span>
           <span class="token keyword">when</span> <span class="token number">30</span> <span class="token keyword">then</span> salary <span class="token operator">*</span> <span class="token number">1.3</span>
           <span class="token keyword">end</span> <span class="token keyword">as</span> <span class="token string">&#39;加奖金工资&#39;</span>
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> department_id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="练习-6" tabindex="-1"><a class="header-anchor" href="#练习-6" aria-hidden="true">#</a> 练习</h3><p>-- 1. 显示系统时间(日期+时间)</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>-- 2. 查询员工号,姓名,工资, 以及工资提高20%后的结果</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> employee_id<span class="token punctuation">,</span> salary<span class="token punctuation">,</span> salary <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> <span class="token number">0.2</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> employees<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 3. 将员工的姓名,按照首字母排序,并显示姓名的长度</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> last_name<span class="token punctuation">,</span> length<span class="token punctuation">(</span>last_name<span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token string">&#39;长度&#39;</span>
<span class="token keyword">from</span> employees
<span class="token keyword">order</span> <span class="token keyword">by</span> last_name<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 4. 查询员工的id,last_name, salary ,并作为一个列输出,别名为out_put</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> concat_ws<span class="token punctuation">(</span><span class="token string">&#39;-&#39;</span><span class="token punctuation">,</span> employee_id<span class="token punctuation">,</span> last_name<span class="token punctuation">,</span> salary<span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token string">&#39;out_put&#39;</span>
<span class="token keyword">from</span> employees
<span class="token keyword">order</span> <span class="token keyword">by</span> salary<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 5.查询公司员工的工作年数,工作天数,并按照工作年数降序排序</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> timestampdiff<span class="token punctuation">(</span><span class="token keyword">YEAR</span><span class="token punctuation">,</span> hire_date<span class="token punctuation">,</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token string">&#39;工作年数&#39;</span><span class="token punctuation">,</span>
       timestampdiff<span class="token punctuation">(</span><span class="token keyword">DAY</span><span class="token punctuation">,</span> hire_date<span class="token punctuation">,</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token keyword">as</span> <span class="token string">&#39;工作天数&#39;</span><span class="token punctuation">,</span>
       hire_date<span class="token punctuation">,</span>
       <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> employees
<span class="token keyword">order</span> <span class="token keyword">by</span> timestampdiff<span class="token punctuation">(</span><span class="token keyword">YEAR</span><span class="token punctuation">,</span> hire_date<span class="token punctuation">,</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">desc</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 6. 查询员工姓名,hire_date,department_id ,满足以下条件: 雇用时间在1997年之后,department_id 为 80 90或110,commission_pct不为空</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> last_name<span class="token punctuation">,</span> hire_date<span class="token punctuation">,</span> department_id<span class="token punctuation">,</span> commission_pct
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> department_id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">)</span>
  <span class="token operator">and</span> commission_pct <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>
  <span class="token operator">and</span> unix_timestamp<span class="token punctuation">(</span>hire_date<span class="token punctuation">)</span> <span class="token operator">&gt;</span> unix_timestamp<span class="token punctuation">(</span><span class="token string">&#39;1997-1-1&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> hire_date<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 7. 查询入职超过10000天的员工的姓名,入职时间</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> last_name<span class="token punctuation">,</span> hire_date<span class="token punctuation">,</span> timestampdiff<span class="token punctuation">(</span><span class="token keyword">DAY</span><span class="token punctuation">,</span> hire_date<span class="token punctuation">,</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token string">&#39;入职天数&#39;</span>
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> timestampdiff<span class="token punctuation">(</span><span class="token keyword">DAY</span><span class="token punctuation">,</span> hire_date<span class="token punctuation">,</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">10000</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> timestampdiff<span class="token punctuation">(</span><span class="token keyword">DAY</span><span class="token punctuation">,</span> hire_date<span class="token punctuation">,</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 8. 查询产生一下结果 <code>&lt;last_name&gt; earns &lt;salary&gt; ,&#39;monthly but wants &#39; &lt;salary*3&gt;</code></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> concat_ws<span class="token punctuation">(</span><span class="token string">&#39; &#39;</span><span class="token punctuation">,</span> last_name<span class="token punctuation">,</span> <span class="token string">&#39;earns&#39;</span><span class="token punctuation">,</span> <span class="token keyword">truncate</span><span class="token punctuation">(</span>salary<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;monthly but wants &#39;</span><span class="token punctuation">,</span>
                 <span class="token keyword">truncate</span><span class="token punctuation">(</span>salary <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token string">&#39;dream salary&#39;</span>
<span class="token keyword">from</span> employees<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 9. 使用case-when ,按照下面条件查询 -- job grade -- AD_PRES A -- ST_MAN B -- IT_PROG C -- SA_REP D -- ST_CLERK E</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> job_id<span class="token punctuation">,</span>
       <span class="token keyword">case</span> job_id
           <span class="token keyword">when</span> <span class="token string">&#39;AD_PRES &#39;</span> <span class="token keyword">then</span> <span class="token string">&#39;A&#39;</span>
           <span class="token keyword">when</span> <span class="token string">&#39;ST_MAN &#39;</span> <span class="token keyword">then</span> <span class="token string">&#39;B&#39;</span>
           <span class="token keyword">when</span> <span class="token string">&#39;IT_PROG &#39;</span> <span class="token keyword">then</span> <span class="token string">&#39;C&#39;</span>
           <span class="token keyword">when</span> <span class="token string">&#39;SA_REP &#39;</span> <span class="token keyword">then</span> <span class="token string">&#39;D&#39;</span>
           <span class="token keyword">when</span> <span class="token string">&#39;ST_CLERK &#39;</span> <span class="token keyword">then</span> <span class="token string">&#39;E&#39;</span>
           <span class="token keyword">else</span> <span class="token string">&#39;F&#39;</span>
           <span class="token keyword">end</span> <span class="token keyword">as</span> grade
<span class="token keyword">from</span> employees
<span class="token keyword">order</span> <span class="token keyword">by</span> grade <span class="token keyword">asc</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="单行函数-1" tabindex="-1"><a class="header-anchor" href="#单行函数-1" aria-hidden="true">#</a> 单行函数</h3><h3 id="聚合函数" tabindex="-1"><a class="header-anchor" href="#聚合函数" aria-hidden="true">#</a> ---- 聚合函数 -----</h3><p>-- 平均值 ,总数</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
<span class="token keyword">from</span> employees<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>-- count 计算指定字段在查询结果中出现的个数</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span>job_id<span class="token punctuation">)</span><span class="token punctuation">,</span> job_id
<span class="token keyword">from</span> employees
<span class="token keyword">group</span> <span class="token keyword">by</span> job_id<span class="token punctuation">;</span>

<span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> employees<span class="token punctuation">;</span>

<span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>commission_pct<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span>commission_pct<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">count</span><span class="token punctuation">(</span>commission_pct<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span>commission_pct<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> employees<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 计算平均奖金率</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token function">sum</span><span class="token punctuation">(</span>commission_pct<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">count</span><span class="token punctuation">(</span>ifnull<span class="token punctuation">(</span>commission_pct<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token string">&#39;平均奖金率&#39;</span>
<span class="token keyword">from</span> employees<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="group-by" tabindex="-1"><a class="header-anchor" href="#group-by" aria-hidden="true">#</a> group by</h3><p>-- 查询各个部门的平均工资,最高工资</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">,</span> d<span class="token punctuation">.</span>department_name<span class="token punctuation">,</span> <span class="token function">min</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">avg</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">max</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
<span class="token keyword">from</span> employees <span class="token keyword">as</span> e
         <span class="token keyword">right</span> <span class="token keyword">join</span> departments <span class="token keyword">as</span> d
                    <span class="token keyword">on</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id
<span class="token keyword">group</span> <span class="token keyword">by</span> department_id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 查询各个department_id,job_id的平均工资</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span> department_id<span class="token punctuation">,</span> job_id
<span class="token keyword">from</span> employees
<span class="token keyword">group</span> <span class="token keyword">by</span> department_id<span class="token punctuation">,</span> job_id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- with rollup</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> department_id<span class="token punctuation">,</span> <span class="token function">avg</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> department_id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">)</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> department_id
<span class="token keyword">with rollup</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- having 用来过滤数据 ,如果过滤条件中使用了聚合函数,则必须使用having来替代where -- 查询各个部门中最高工资比10000高的部门信息</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token function">max</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span> d<span class="token punctuation">.</span>department_name
<span class="token keyword">from</span> employees <span class="token keyword">as</span> e
         <span class="token keyword">join</span> departments <span class="token keyword">as</span> d
              <span class="token keyword">on</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id
<span class="token keyword">group</span> <span class="token keyword">by</span> e<span class="token punctuation">.</span>department_id
<span class="token keyword">having</span> <span class="token function">max</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">10000</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 练习: 查询部门id为10,20,30 40这四个部门中最高工资比10000高的部门信息 -- 第一种方式 ,推荐使用</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token function">max</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">,</span> d<span class="token punctuation">.</span>department_name
<span class="token keyword">from</span> employees <span class="token keyword">as</span> e
         <span class="token keyword">join</span> departments <span class="token keyword">as</span> d
              <span class="token keyword">on</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id <span class="token operator">and</span> d<span class="token punctuation">.</span>department_id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> e<span class="token punctuation">.</span>department_id
<span class="token keyword">having</span> <span class="token function">max</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">10000</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 第二种方式</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token function">max</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">,</span> d<span class="token punctuation">.</span>department_name
<span class="token keyword">from</span> employees <span class="token keyword">as</span> e
         <span class="token keyword">join</span> departments <span class="token keyword">as</span> d
              <span class="token keyword">on</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id
<span class="token keyword">group</span> <span class="token keyword">by</span> e<span class="token punctuation">.</span>department_id
<span class="token keyword">having</span> <span class="token function">max</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">10000</span>
   <span class="token operator">and</span> department_id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="练习-7" tabindex="-1"><a class="header-anchor" href="#练习-7" aria-hidden="true">#</a> 练习</h4><p>-- 1. where子句是否可以使用组函数进行过滤 ?</p><blockquote><p>不可以,需要使用having</p></blockquote><p>-- 2. 查询公司员工工资的最大值,最小值,平均值,求和</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token function">max</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">min</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">avg</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
<span class="token keyword">from</span> employees<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 3. 查询各job_id的员工的工资的最大值,最小值,平均值,总和</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> job_id<span class="token punctuation">,</span> <span class="token function">max</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">min</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">avg</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
<span class="token keyword">from</span> employees
<span class="token keyword">group</span> <span class="token keyword">by</span> job_id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 4. 选择具有各个job_id的员工的工人数</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> job_id<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> employees
<span class="token keyword">group</span> <span class="token keyword">by</span> job_id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 5. 查询员工最高工资和最低工资的的差距(difference)</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token function">max</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">min</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token function">max</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token function">min</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token string">&#39;difference&#39;</span>
<span class="token keyword">from</span> employees<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 6. 查询各个管理者手下员工的最低工资,其中最低工资不能低于6000,没有管理者的员工不计算在内</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> manager_id<span class="token punctuation">,</span> <span class="token function">min</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> salary <span class="token operator">&gt;=</span> <span class="token number">6000</span>
  <span class="token operator">and</span> manager_id <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> manager_id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 7. 查询所有部门的名字,location_id,员工数量和平均工资,按照平均工资降序</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> d<span class="token punctuation">.</span>department_name<span class="token punctuation">,</span> d<span class="token punctuation">.</span>location_id<span class="token punctuation">,</span> <span class="token function">min</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>employee_id<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">avg</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>salary<span class="token punctuation">)</span>
<span class="token keyword">from</span> employees <span class="token keyword">as</span> e
         <span class="token keyword">right</span> <span class="token keyword">join</span> departments <span class="token keyword">as</span> d
                    <span class="token keyword">on</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id
<span class="token keyword">group</span> <span class="token keyword">by</span> d<span class="token punctuation">.</span>department_id
<span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token function">avg</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>salary<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 8. 查询每个工种,每个部门的的部门名,工种名和最低工资</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token function">min</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span> d<span class="token punctuation">.</span>department_name<span class="token punctuation">,</span> j<span class="token punctuation">.</span>job_title
<span class="token keyword">from</span> employees <span class="token keyword">as</span> e
         <span class="token keyword">right</span> <span class="token keyword">join</span> departments <span class="token keyword">as</span> d
                    <span class="token keyword">on</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id
         <span class="token keyword">join</span> jobs <span class="token keyword">as</span> j
              <span class="token keyword">on</span> e<span class="token punctuation">.</span>job_id <span class="token operator">=</span> j<span class="token punctuation">.</span>job_id
<span class="token keyword">group</span> <span class="token keyword">by</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">,</span> j<span class="token punctuation">.</span>job_id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="聚合函数-1" tabindex="-1"><a class="header-anchor" href="#聚合函数-1" aria-hidden="true">#</a> ---- 聚合函数 -----</h3><h3 id="子查询" tabindex="-1"><a class="header-anchor" href="#子查询" aria-hidden="true">#</a> ---- 子查询 -----</h3><p>-- 练习 -- 1. 谁比Abel工资高 -- 方式 1,使用子查询</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> last_name<span class="token punctuation">,</span> salary
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> salary <span class="token operator">&gt;=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> salary <span class="token keyword">from</span> employees <span class="token keyword">where</span> last_name <span class="token operator">=</span> <span class="token string">&#39;Abel&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> salary<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 方式2 ,使用自连接</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> t1<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> t1<span class="token punctuation">.</span>salary
<span class="token keyword">from</span> employees <span class="token keyword">as</span> t1
         <span class="token keyword">join</span> employees <span class="token keyword">as</span> t2
<span class="token keyword">where</span> t1<span class="token punctuation">.</span>salary <span class="token operator">&gt;=</span> t2<span class="token punctuation">.</span>salary
  <span class="token operator">and</span> t2<span class="token punctuation">.</span>last_name <span class="token operator">=</span> <span class="token string">&#39;Abel&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 2. 查询大于公司平均工资的员工</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> salary<span class="token punctuation">,</span> last_name
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> salary <span class="token operator">&gt;</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
                <span class="token keyword">from</span> employees<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 2. 查询大于部门平均工资的员工</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> salary<span class="token punctuation">,</span> last_name<span class="token punctuation">,</span> department_id
<span class="token keyword">from</span> employees <span class="token keyword">as</span> t1
<span class="token keyword">where</span> salary <span class="token operator">&gt;=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">from</span> employees <span class="token keyword">where</span> department_id <span class="token operator">=</span> t1<span class="token punctuation">.</span>department_id<span class="token punctuation">)</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> salary<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 3. 查询工资大于149号员工工资的员工信息</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> salary <span class="token operator">&gt;</span> <span class="token punctuation">(</span><span class="token keyword">select</span> salary <span class="token keyword">from</span> employees <span class="token keyword">where</span> employee_id <span class="token operator">=</span> <span class="token number">149</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 4. 查询job_id与141号员工相同,salary 比143号员工多的员工信息</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> job_id <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> job_id <span class="token keyword">from</span> employees <span class="token keyword">where</span> employee_id <span class="token operator">=</span> <span class="token number">141</span><span class="token punctuation">)</span>
  <span class="token operator">and</span> salary <span class="token operator">&gt;</span> <span class="token punctuation">(</span><span class="token keyword">select</span> salary <span class="token keyword">from</span> employees <span class="token keyword">where</span> employee_id <span class="token operator">=</span> <span class="token number">143</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 5. 查询与141号或174号员工的manager_id和department_id相同的,其他员工的</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>employee_id<span class="token punctuation">,</span>manager_id<span class="token punctuation">,</span>department_id
<span class="token keyword">select</span> employee_id<span class="token punctuation">,</span> manager_id<span class="token punctuation">,</span> department_id
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> <span class="token punctuation">(</span>manager_id<span class="token punctuation">,</span> department_id<span class="token punctuation">)</span>
    <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> manager_id<span class="token punctuation">,</span> department_id <span class="token keyword">from</span> employees <span class="token keyword">where</span> employee_id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">141</span><span class="token punctuation">,</span> <span class="token number">174</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token operator">and</span> employee_id <span class="token operator">not</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">141</span><span class="token punctuation">,</span> <span class="token number">174</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">select</span> employee_id<span class="token punctuation">,</span> manager_id<span class="token punctuation">,</span> department_id
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> manager_id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> manager_id <span class="token keyword">from</span> employees <span class="token keyword">where</span> employee_id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">141</span><span class="token punctuation">,</span> <span class="token number">174</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token operator">and</span> department_id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> department_id
                        <span class="token keyword">from</span> employees
                        <span class="token keyword">where</span> employee_id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">141</span><span class="token punctuation">,</span>
                                              <span class="token number">174</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token operator">and</span> employee_id <span class="token operator">not</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">141</span><span class="token punctuation">,</span> <span class="token number">174</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 6. 查询最低工资大于50号部门最低工资的部门id和最低工资</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> department_id<span class="token punctuation">,</span> <span class="token function">min</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
<span class="token keyword">from</span> employees
<span class="token keyword">group</span> <span class="token keyword">by</span> department_id
<span class="token keyword">having</span> <span class="token function">min</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">min</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">from</span> employees <span class="token keyword">where</span> department_id <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">)</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token function">min</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 7. 查询员工的employee_id,last_name和location, -- 若员工的department_id 和 location_id为1800department_id相同 -- 则country为&#39;Canada&#39;,其余则为&#39;USA&#39;</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> employee_id<span class="token punctuation">,</span>
       last_name<span class="token punctuation">,</span>
       l<span class="token punctuation">.</span>location_id<span class="token punctuation">,</span>
       e<span class="token punctuation">.</span>department_id<span class="token punctuation">,</span>
       l<span class="token punctuation">.</span>street_address<span class="token punctuation">,</span>
       <span class="token keyword">if</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>department_id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> department_id
                              <span class="token keyword">from</span> employees
                              <span class="token keyword">where</span> department_id <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> department_id
                                                     <span class="token keyword">from</span> departments
                                                     <span class="token keyword">where</span> location_id <span class="token operator">=</span> <span class="token number">1800</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;Canada&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;USA&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> country
<span class="token keyword">from</span> employees <span class="token keyword">as</span> e
         <span class="token keyword">left</span> <span class="token keyword">join</span> departments <span class="token keyword">as</span> d
                   <span class="token keyword">on</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id
         <span class="token keyword">left</span> <span class="token keyword">join</span> locations <span class="token keyword">as</span> l
                   <span class="token keyword">on</span> d<span class="token punctuation">.</span>location_id <span class="token operator">=</span> l<span class="token punctuation">.</span>location_id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="多行子查询" tabindex="-1"><a class="header-anchor" href="#多行子查询" aria-hidden="true">#</a> 多行子查询</h3><p>-- in -- 1. 查询工资是各部门最低工资的员工</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> salary <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">min</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
                 <span class="token keyword">from</span> employees
                 <span class="token keyword">group</span> <span class="token keyword">by</span> department_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- any /some -- all -- 1. 返回其他job_id中比job_id为&#39;IT_PROG&#39;部门任一工资低的员工信息</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> last_name<span class="token punctuation">,</span> job_id<span class="token punctuation">,</span> salary
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> salary <span class="token operator">&lt;</span> <span class="token keyword">some</span> <span class="token punctuation">(</span><span class="token keyword">select</span> salary <span class="token keyword">from</span> employees <span class="token keyword">where</span> job_id <span class="token operator">=</span> <span class="token string">&#39;IT_PROG&#39;</span><span class="token punctuation">)</span>
  <span class="token operator">and</span> job_id <span class="token operator">!=</span> <span class="token string">&#39;IT_PROG&#39;</span><span class="token punctuation">;</span> <span class="token comment">-- 76 rows</span>

<span class="token keyword">select</span> last_name<span class="token punctuation">,</span> job_id<span class="token punctuation">,</span> salary
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> salary <span class="token operator">&lt;</span> <span class="token keyword">all</span> <span class="token punctuation">(</span><span class="token keyword">select</span> salary <span class="token keyword">from</span> employees <span class="token keyword">where</span> job_id <span class="token operator">=</span> <span class="token string">&#39;IT_PROG&#39;</span><span class="token punctuation">)</span>
  <span class="token operator">and</span> job_id <span class="token operator">!=</span> <span class="token string">&#39;IT_PROG&#39;</span><span class="token punctuation">;</span> <span class="token comment">-- 1 rows</span>

<span class="token keyword">select</span> last_name<span class="token punctuation">,</span> job_id<span class="token punctuation">,</span> salary
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> salary <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> salary <span class="token keyword">from</span> employees <span class="token keyword">where</span> job_id <span class="token operator">=</span> <span class="token string">&#39;IT_PROG&#39;</span><span class="token punctuation">)</span>
  <span class="token operator">and</span> job_id <span class="token operator">!=</span> <span class="token string">&#39;IT_PROG&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 查询平均工资最低的部门id</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- 方法1</span>
<span class="token keyword">select</span> department_id<span class="token punctuation">,</span> <span class="token function">avg</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
<span class="token keyword">from</span> employees
<span class="token keyword">group</span> <span class="token keyword">by</span> department_id
<span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token function">avg</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
<span class="token keyword">limit</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">;</span>

<span class="token comment">-- 方法2</span>
<span class="token keyword">select</span> department_id
<span class="token keyword">from</span> employees
<span class="token keyword">group</span> <span class="token keyword">by</span> department_id
<span class="token keyword">having</span> <span class="token function">avg</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">min</span><span class="token punctuation">(</span>avg_salary<span class="token punctuation">)</span>
                      <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">as</span> avg_salary
                            <span class="token keyword">from</span> employees
                            <span class="token keyword">group</span> <span class="token keyword">by</span> department_id<span class="token punctuation">)</span> <span class="token keyword">as</span> t_dep_avg<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 方法3</span>
<span class="token keyword">select</span> department_id
<span class="token keyword">from</span> employees
<span class="token keyword">group</span> <span class="token keyword">by</span> department_id
<span class="token keyword">having</span> <span class="token function">avg</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token keyword">all</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">as</span> avg_salary
                           <span class="token keyword">from</span> employees
                           <span class="token keyword">group</span> <span class="token keyword">by</span> department_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="相关子查询" tabindex="-1"><a class="header-anchor" href="#相关子查询" aria-hidden="true">#</a> 相关子查询</h3><p>-- 1. 查询员工中工资大于本部门平均工资的员工的信息</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- 方式1</span>
<span class="token keyword">select</span> t1<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> t1<span class="token punctuation">.</span>salary<span class="token punctuation">,</span> t1<span class="token punctuation">.</span>department_id
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees <span class="token keyword">as</span> t1
<span class="token keyword">where</span> salary <span class="token operator">&gt;</span>
      <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
       <span class="token keyword">from</span> employees <span class="token keyword">as</span> t2
       <span class="token keyword">where</span> t1<span class="token punctuation">.</span>department_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>department_id<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 方式2,在from 中使用子查询</span>
<span class="token keyword">select</span> t1<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> t1<span class="token punctuation">.</span>salary<span class="token punctuation">,</span> t1<span class="token punctuation">.</span>department_id
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees <span class="token keyword">as</span> t1<span class="token punctuation">,</span>
     <span class="token punctuation">(</span><span class="token keyword">select</span> department_id<span class="token punctuation">,</span> <span class="token function">avg</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">as</span> dept_avg_salary <span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees <span class="token keyword">group</span> <span class="token keyword">by</span> department_id<span class="token punctuation">)</span> <span class="token keyword">as</span> t2
<span class="token keyword">where</span> t1<span class="token punctuation">.</span>department_id <span class="token operator">=</span> t2<span class="token punctuation">.</span>department_id
  <span class="token operator">and</span> t1<span class="token punctuation">.</span>salary <span class="token operator">&gt;</span> t2<span class="token punctuation">.</span>dept_avg_salary<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 2. 查询员工的id,salary 按照department_name排序</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- 方式一</span>
<span class="token keyword">select</span> e<span class="token punctuation">.</span>department_id<span class="token punctuation">,</span> e<span class="token punctuation">.</span>salary<span class="token punctuation">,</span> department_name
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees <span class="token keyword">as</span> e
         <span class="token keyword">left</span> <span class="token keyword">join</span> atguigudb<span class="token punctuation">.</span>departments <span class="token keyword">as</span> d
                   <span class="token keyword">on</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id
<span class="token keyword">order</span> <span class="token keyword">by</span> d<span class="token punctuation">.</span>department_name<span class="token punctuation">;</span>
<span class="token comment">-- 方式2</span>
<span class="token keyword">select</span> e<span class="token punctuation">.</span>department_id<span class="token punctuation">,</span>
       e<span class="token punctuation">.</span>salary<span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token keyword">select</span> d<span class="token punctuation">.</span>department_name
        <span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>departments <span class="token keyword">as</span> d
        <span class="token keyword">where</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">)</span> <span class="token keyword">as</span> department_name
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees <span class="token keyword">as</span> e
<span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token punctuation">(</span><span class="token keyword">select</span> d<span class="token punctuation">.</span>department_name <span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>departments <span class="token keyword">as</span> d <span class="token keyword">where</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 3. 若employees表中的employee_id 与 job_history表中的employee_id相同的数目不小于2, -- 输出这些相同id的员工的employee_id,last_name和其job_id</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> e<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> e<span class="token punctuation">.</span>job_id
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees <span class="token keyword">as</span> e
<span class="token keyword">where</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>job_history <span class="token keyword">as</span> j <span class="token keyword">where</span> j<span class="token punctuation">.</span>employee_id <span class="token operator">=</span> e<span class="token punctuation">.</span>employee_id<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">2</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 4. 查询公司管理者的employee_id,last_name,job_id,department_id 信息</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- 方式1 自连接</span>
<span class="token keyword">select</span> e<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> e<span class="token punctuation">.</span>job_id<span class="token punctuation">,</span> e<span class="token punctuation">.</span>department_id
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees <span class="token keyword">as</span> e
<span class="token keyword">where</span> e<span class="token punctuation">.</span>employee_id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">distinct</span> manager_id <span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 方式2 子查询</span>
<span class="token keyword">select</span> <span class="token keyword">distinct</span> m<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span> m<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> m<span class="token punctuation">.</span>job_id<span class="token punctuation">,</span> m<span class="token punctuation">.</span>department_id
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees <span class="token keyword">as</span> e
         <span class="token keyword">join</span> atguigudb<span class="token punctuation">.</span>employees <span class="token keyword">as</span> m
              <span class="token keyword">on</span> e<span class="token punctuation">.</span>manager_id <span class="token operator">=</span> m<span class="token punctuation">.</span>employee_id<span class="token punctuation">;</span>
<span class="token comment">-- 方式3 使用exists</span>
<span class="token keyword">select</span> e<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> e<span class="token punctuation">.</span>job_id<span class="token punctuation">,</span> e<span class="token punctuation">.</span>department_id
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees <span class="token keyword">as</span> e
<span class="token keyword">where</span> <span class="token keyword">exists</span><span class="token punctuation">(</span>
              <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees <span class="token keyword">as</span> m <span class="token keyword">where</span> e<span class="token punctuation">.</span>employee_id <span class="token operator">=</span> m<span class="token punctuation">.</span>manager_id
          <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 5.查询departments表中,不存在于employees表中的 department_id,department_name</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- 方法1</span>
<span class="token keyword">select</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">,</span> d<span class="token punctuation">.</span>department_name
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>departments <span class="token keyword">as</span> d
         <span class="token keyword">left</span> <span class="token keyword">join</span> atguigudb<span class="token punctuation">.</span>employees <span class="token keyword">as</span> e
                   <span class="token keyword">on</span> d<span class="token punctuation">.</span>department_id <span class="token operator">=</span> e<span class="token punctuation">.</span>department_id
<span class="token keyword">where</span> e<span class="token punctuation">.</span>department_id <span class="token operator">is</span> <span class="token boolean">null</span><span class="token punctuation">;</span>

<span class="token comment">-- 方法2</span>
<span class="token keyword">select</span> department_id<span class="token punctuation">,</span> department_name
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>departments <span class="token keyword">as</span> e
<span class="token keyword">where</span> <span class="token operator">not</span> <span class="token keyword">exists</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees <span class="token keyword">as</span> d <span class="token keyword">where</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="练习-8" tabindex="-1"><a class="header-anchor" href="#练习-8" aria-hidden="true">#</a> 练习</h3><p>-- 1. 查询和Zlotkey 相同部门的员工姓名和工资</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> last_name<span class="token punctuation">,</span> salary<span class="token punctuation">,</span> department_id
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees
<span class="token keyword">where</span> department_id <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> department_id
                       <span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees
                       <span class="token keyword">where</span> last_name <span class="token operator">=</span> <span class="token string">&#39;Zlotkey&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 2. 查询工资比公司平均工资高的员工的员工号,姓名,和工资</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> t<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> t<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span> t<span class="token punctuation">.</span>salary
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees <span class="token keyword">as</span> t
<span class="token keyword">where</span> salary <span class="token operator">&gt;</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
                <span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees<span class="token punctuation">)</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> salary<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 3. 查询工资大于所有job_id =&#39;SA_MAN&#39;的员工的工资定的员工的last_name,job_id, salary</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> last_name<span class="token punctuation">,</span> job_id<span class="token punctuation">,</span> salary
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees
<span class="token keyword">where</span> salary <span class="token operator">&gt;</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">max</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
                <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> salary
                      <span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees
                      <span class="token keyword">where</span> job_id <span class="token operator">=</span> <span class="token string">&#39;SA_MAN&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> t<span class="token punctuation">)</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> salary<span class="token punctuation">;</span>


<span class="token keyword">select</span> last_name<span class="token punctuation">,</span> job_id<span class="token punctuation">,</span> salary
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees
<span class="token keyword">where</span> salary <span class="token operator">&gt;</span> <span class="token keyword">all</span> <span class="token punctuation">(</span><span class="token keyword">select</span> salary
                    <span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees
                    <span class="token keyword">where</span> job_id <span class="token operator">=</span> <span class="token string">&#39;SA_MAN&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> salary<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 4. 查询和姓名中包含字母u的员工在相同部门的员工的员工号和姓名</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> employee_id<span class="token punctuation">,</span> last_name
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees
<span class="token keyword">where</span> department_id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> department_id
                        <span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees
                        <span class="token keyword">where</span> last_name <span class="token operator">like</span> <span class="token string">&#39;%u%&#39;</span>
                           <span class="token operator">or</span> <span class="token string">&#39;%U%&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 5. 查询在部门的location_id为1700的部门工作的员工和员工号</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> last_name<span class="token punctuation">,</span> employee_id<span class="token punctuation">,</span> department_id
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees
<span class="token keyword">where</span> department_id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> department_id
                        <span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>departments
                        <span class="token keyword">where</span> location_id <span class="token operator">=</span> <span class="token number">1700</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 6. 查询管理者是King的员工的姓名和工资</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> last_name<span class="token punctuation">,</span> salary<span class="token punctuation">,</span> manager_id
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees
<span class="token keyword">where</span> manager_id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> employee_id <span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees <span class="token keyword">where</span> last_name <span class="token operator">=</span> <span class="token string">&#39;King&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 7. 查询公司最低的员工信息,last_name ,salary</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> last_name<span class="token punctuation">,</span> salary
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees
<span class="token keyword">where</span> salary <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">min</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
                <span class="token keyword">from</span> employees<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 8. 查询平均工资最低的部门信息</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>departments
<span class="token keyword">where</span> department_id <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> department_id
                       <span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees
                       <span class="token keyword">group</span> <span class="token keyword">by</span> department_id
                       <span class="token keyword">having</span> <span class="token function">avg</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">min</span><span class="token punctuation">(</span>avg_salary<span class="token punctuation">)</span>
                                             <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">as</span> avg_salary<span class="token punctuation">,</span> department_id <span class="token keyword">as</span> dpt_id
                                                   <span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees
                                                   <span class="token keyword">group</span> <span class="token keyword">by</span> department_id<span class="token punctuation">)</span> <span class="token keyword">as</span> t<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 方法2 &lt;= all</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>departments
<span class="token keyword">where</span> department_id <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> department_id
                       <span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees
                       <span class="token keyword">group</span> <span class="token keyword">by</span> department_id
                       <span class="token keyword">having</span> <span class="token function">avg</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token keyword">all</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
                                                  <span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees
                                                  <span class="token keyword">group</span> <span class="token keyword">by</span> department_id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 方法3 使用limit</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 9. 查询平均工资最低的部门信息,和该部门的平均工资(相关子查询)</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees <span class="token keyword">where</span> departments<span class="token punctuation">.</span>department_id <span class="token operator">=</span> employees<span class="token punctuation">.</span>department_id<span class="token punctuation">)</span>
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>departments
<span class="token keyword">where</span> department_id <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> department_id
                       <span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees
                       <span class="token keyword">group</span> <span class="token keyword">by</span> department_id
                       <span class="token keyword">having</span> <span class="token function">avg</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">min</span><span class="token punctuation">(</span>avg_salary<span class="token punctuation">)</span>
                                             <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">as</span> avg_salary<span class="token punctuation">,</span> department_id <span class="token keyword">as</span> dpt_id
                                                   <span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees
                                                   <span class="token keyword">group</span> <span class="token keyword">by</span> department_id<span class="token punctuation">)</span> <span class="token keyword">as</span> t<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 10. 查询平均工资最高的job 信息</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>jobs
<span class="token keyword">where</span> job_id <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> job_id
                <span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees
                <span class="token keyword">group</span> <span class="token keyword">by</span> job_id
                <span class="token keyword">having</span> <span class="token function">avg</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">max</span><span class="token punctuation">(</span>avg_salary<span class="token punctuation">)</span>
                                      <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">as</span> avg_salary
                                            <span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees
                                            <span class="token keyword">group</span> <span class="token keyword">by</span> job_id<span class="token punctuation">)</span> <span class="token keyword">as</span> t1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 11. 查询平均工资高于公司平均工资的部门</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> department_id
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees
<span class="token keyword">where</span> department_id <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> department_id
<span class="token keyword">having</span> <span class="token function">avg</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
                      <span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 12. 查询公司中所有manager的详细信息</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- 方式1</span>
<span class="token keyword">select</span> last_name<span class="token punctuation">,</span> employee_id<span class="token punctuation">,</span> manager_id
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees
<span class="token keyword">where</span> employee_id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> manager_id
                      <span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 方式2 自连接</span>
<span class="token keyword">select</span> last_name<span class="token punctuation">,</span> employee_id<span class="token punctuation">,</span> manager_id
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees
<span class="token keyword">where</span> employee_id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> manager_id
                      <span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 方式3 使用exists</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 13. 各个部门中 最高工资最低的那个部门的最低工资是多少</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- 方法1</span>
<span class="token keyword">select</span> department_id<span class="token punctuation">,</span> <span class="token function">min</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees
<span class="token keyword">group</span> <span class="token keyword">by</span> department_id
<span class="token keyword">having</span> <span class="token function">max</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">min</span><span class="token punctuation">(</span>max_salry<span class="token punctuation">)</span>
                      <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">max</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">as</span> max_salry
                            <span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees
                            <span class="token keyword">group</span> <span class="token keyword">by</span> department_id
                            <span class="token keyword">having</span> <span class="token function">max</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">-- 方式2</span>
<span class="token keyword">select</span> department_id<span class="token punctuation">,</span> <span class="token function">min</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees
<span class="token keyword">group</span> <span class="token keyword">by</span> department_id
<span class="token keyword">having</span> <span class="token function">max</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token keyword">all</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">max</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
                           <span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees
                           <span class="token keyword">group</span> <span class="token keyword">by</span> department_id<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">-- 方法3</span>
<span class="token keyword">select</span> department_id<span class="token punctuation">,</span> <span class="token function">min</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees
<span class="token keyword">group</span> <span class="token keyword">by</span> department_id
<span class="token keyword">having</span> department_id <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> department_id
                        <span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees
                        <span class="token keyword">group</span> <span class="token keyword">by</span> department_id
                        <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token function">max</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">asc</span>
                        <span class="token keyword">limit</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 方式4</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees <span class="token keyword">as</span> e<span class="token punctuation">,</span>
     <span class="token punctuation">(</span><span class="token keyword">select</span> department_id<span class="token punctuation">,</span> <span class="token function">max</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
      <span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees
      <span class="token keyword">group</span> <span class="token keyword">by</span> department_id
      <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token function">max</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">asc</span>
      <span class="token keyword">limit</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">as</span> t
<span class="token keyword">where</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> t<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 14.查询平均工资最高的部门的manager 的详细信息,last_name,department_id ,email , salary</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> last_name<span class="token punctuation">,</span> department_id<span class="token punctuation">,</span> email<span class="token punctuation">,</span> salary
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees
<span class="token keyword">where</span> employee_id <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">distinct</span> manager_id
                     <span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees
                     <span class="token keyword">where</span> department_id <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> department_id
                                            <span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees
                                            <span class="token keyword">group</span> <span class="token keyword">by</span> department_id
                                            <span class="token keyword">having</span> <span class="token function">avg</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
                                                                  <span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees
                                                                  <span class="token keyword">group</span> <span class="token keyword">by</span> department_id
                                                                  <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token function">avg</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">desc</span>
                                                                  <span class="token keyword">limit</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                       <span class="token operator">and</span> manager_id <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 15. 查询部门的部门号,其中不包括job_id是&#39;ST_CLERK&#39;的部门号</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> department_id
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>departments
<span class="token keyword">where</span> department_id <span class="token operator">not</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">distinct</span> department_id
                            <span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees
                            <span class="token keyword">where</span> job_id <span class="token operator">=</span> <span class="token string">&#39;ST_CLERK&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 16. 查询所有没有管理者的的员工的last_name</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> last_name
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees
<span class="token keyword">where</span> manager_id <span class="token operator">is</span> <span class="token boolean">null</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 17.查询员工号,姓名,雇佣时间,工资,其中员工的管理者为&#39;De Haan&#39;</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> employee_id<span class="token punctuation">,</span> last_name<span class="token punctuation">,</span> hire_date<span class="token punctuation">,</span> salary
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees
<span class="token keyword">where</span> manager_id <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> employee_id
                    <span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees
                    <span class="token keyword">where</span> last_name <span class="token operator">=</span> <span class="token string">&#39;De Haan&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 18.查询各个部门中工资比本部门平均工资高的员工的员工号,姓名和工资(相关子查询)</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> employee_id<span class="token punctuation">,</span> last_name<span class="token punctuation">,</span> salary
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees <span class="token keyword">as</span> e
<span class="token keyword">where</span> salary <span class="token operator">&gt;</span>
      <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees <span class="token keyword">group</span> <span class="token keyword">by</span> department_id <span class="token keyword">having</span> department_id <span class="token operator">=</span> e<span class="token punctuation">.</span>department_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 19. 查询每个部门下的部门人数大于 5的部门名称(相关子查询)</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>departments
<span class="token keyword">where</span> department_id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> department_id
                        <span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees
                        <span class="token keyword">group</span> <span class="token keyword">by</span> department_id
                        <span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span>employee_id<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 方式2</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>departments <span class="token keyword">as</span> d
<span class="token keyword">where</span> <span class="token number">5</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees <span class="token keyword">as</span> e <span class="token keyword">where</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 20. 查询每个国家下的部门个数大于 2 的国家编号(相关子查询)</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token keyword">distinct</span> country_id
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>locations <span class="token keyword">as</span> l
         <span class="token keyword">join</span> departments <span class="token keyword">as</span> d
              <span class="token keyword">on</span> l<span class="token punctuation">.</span>location_id <span class="token operator">=</span> d<span class="token punctuation">.</span>location_id
         <span class="token keyword">join</span> atguigudb<span class="token punctuation">.</span>employees <span class="token keyword">as</span> e
              <span class="token keyword">on</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id
<span class="token keyword">group</span> <span class="token keyword">by</span> e<span class="token punctuation">.</span>department_id
<span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>department_id<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">2</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="子查询-1" tabindex="-1"><a class="header-anchor" href="#子查询-1" aria-hidden="true">#</a> ---- 子查询 -----</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">show</span> <span class="token keyword">databases</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> my_atguigudb<span class="token punctuation">;</span>
<span class="token keyword">show</span> <span class="token keyword">tables</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> employees<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="添加一个字段" tabindex="-1"><a class="header-anchor" href="#添加一个字段" aria-hidden="true">#</a> 添加一个字段</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">alter</span> <span class="token keyword">table</span> empl
    <span class="token keyword">add</span> employee_id <span class="token keyword">int</span><span class="token punctuation">;</span>
<span class="token comment">-- 指定添加的位置 first after</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> empl
    <span class="token keyword">add</span> phone_number <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">after</span> salary<span class="token punctuation">;</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> empl
    <span class="token keyword">add</span> last_name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">first</span><span class="token punctuation">;</span>
<span class="token keyword">desc</span> empl<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="修改表-修改字段的数据类型-和长度" tabindex="-1"><a class="header-anchor" href="#修改表-修改字段的数据类型-和长度" aria-hidden="true">#</a> 修改表,修改字段的数据类型,和长度</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">alter</span> <span class="token keyword">table</span> empl
    <span class="token keyword">modify</span> employee_id <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">default</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">desc</span> empl<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="重命名表字段" tabindex="-1"><a class="header-anchor" href="#重命名表字段" aria-hidden="true">#</a> 重命名表字段</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">alter</span> <span class="token keyword">table</span> empl
    change e_mail email <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">desc</span> empl<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="删除表字段" tabindex="-1"><a class="header-anchor" href="#删除表字段" aria-hidden="true">#</a> 删除表字段</h1><p>alter table empl add id varchar(25); alter table empl drop column id;</p><h4 id="重命名表" tabindex="-1"><a class="header-anchor" href="#重命名表" aria-hidden="true">#</a> 重命名表</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- 方式1</span>
<span class="token keyword">rename</span> <span class="token keyword">table</span> employees1 <span class="token keyword">to</span> employees_1<span class="token punctuation">;</span>
<span class="token keyword">desc</span> employees_1<span class="token punctuation">;</span>
<span class="token comment">-- 方式2</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> employees_1 <span class="token keyword">rename</span> <span class="token keyword">to</span> employees1<span class="token punctuation">;</span>
<span class="token keyword">show</span> <span class="token keyword">tables</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>删除表</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> employees1<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>清空表</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">truncate</span> <span class="token keyword">table</span> employees1<span class="token punctuation">;</span>
<span class="token keyword">delete</span>
<span class="token keyword">from</span> employees1<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="dcl-中commit-和rollback" tabindex="-1"><a class="header-anchor" href="#dcl-中commit-和rollback" aria-hidden="true">#</a> DCL 中commit 和rollback</h4><blockquote><p>commit:提交数据,一旦执行,则数据被永久保存在数据库中,意味着不可回滚</p><p>rollback :回滚数据,一旦执行rollback ,则可实现数据的回滚,回滚到最近一次commit之后</p><p>truncate table 和 delete from;</p><p>-- truncate table,一旦执行,数据全部清除,同时数据是不可以回滚的 -- delete from 清除数据,但是数据可以实现回滚</p></blockquote><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">commit</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> employees<span class="token punctuation">;</span>
<span class="token keyword">set</span> autocommit <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token keyword">delete</span>
<span class="token keyword">from</span> employees<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> employees<span class="token punctuation">;</span>
<span class="token keyword">rollback</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> employees<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="删除表-并从另一个表中复制数据" tabindex="-1"><a class="header-anchor" href="#删除表-并从另一个表中复制数据" aria-hidden="true">#</a> 删除表,并从另一个表中复制数据</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">drop</span> <span class="token keyword">table</span> employees<span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> employees <span class="token keyword">as</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> employees<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 提交和回滚</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">commit</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> employees<span class="token punctuation">;</span>
<span class="token keyword">set</span> autocommit <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">delete</span>
<span class="token keyword">from</span> employees<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> employees<span class="token punctuation">;</span>
<span class="token keyword">rollback</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> employees<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>课后练习</p><p>-- 1. 创建数据库test01_office ,指明字符集为utf8,并在此数据库下执行一下操作</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">database</span> <span class="token keyword">if</span> <span class="token operator">not</span> <span class="token keyword">exists</span> test01_office <span class="token keyword">character</span> <span class="token keyword">set</span> <span class="token string">&#39;utf8&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">show</span> <span class="token keyword">databases</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 创建表dept01</p><table><thead><tr><th>字段</th><th>类型</th></tr></thead><tbody><tr><td>id</td><td>int(7)</td></tr><tr><td>name</td><td>varchar(25)</td></tr></tbody></table><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">use</span> test01_office<span class="token punctuation">;</span>
<span class="token keyword">show</span> <span class="token keyword">tables</span><span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token operator">not</span> <span class="token keyword">exists</span> dept01
<span class="token punctuation">(</span>
    id   <span class="token keyword">tinyint</span><span class="token punctuation">,</span>
    name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">desc</span> dept01<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 3.将表departments终端数据插入新表dept02中</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token operator">not</span> <span class="token keyword">exists</span> dept02 <span class="token keyword">as</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>departments<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> dept02<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 4. 创建表emp01</p><table><thead><tr><th>字段</th><th>类型</th></tr></thead><tbody><tr><td>id</td><td>int(7)</td></tr><tr><td>first_name</td><td>varchar(25)</td></tr><tr><td>last_name</td><td>varchar(25)</td></tr><tr><td>dept_id</td><td>int(7)</td></tr></tbody></table><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token operator">not</span> <span class="token keyword">exists</span> emp01
<span class="token punctuation">(</span>
    id         <span class="token keyword">tinyint</span><span class="token punctuation">,</span>
    first_name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    last_name  <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    dept_id    <span class="token keyword">tinyint</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">desc</span> emp01<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 5. 将last_name的长度增加到50</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">alter</span> <span class="token keyword">table</span> emp01
    <span class="token keyword">modify</span> last_name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">desc</span> emp01<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 6. 根据表employees创建emp02</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token operator">not</span> <span class="token keyword">exists</span> emp02 <span class="token keyword">as</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees
<span class="token keyword">where</span> <span class="token number">1</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">desc</span> emp02<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 7. 删除表emp01</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">drop</span> <span class="token keyword">table</span> emp01<span class="token punctuation">;</span>
<span class="token keyword">show</span> <span class="token keyword">tables</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 8. 将表emp02重命名为emp01</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">rename</span> <span class="token keyword">table</span> emp02 <span class="token keyword">to</span> emp01<span class="token punctuation">;</span>
<span class="token keyword">show</span> <span class="token keyword">tables</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 9. 在表dept02和emp01中添加新列test_column ,并检查所有的操作</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">alter</span> <span class="token keyword">table</span> dept02
    <span class="token keyword">add</span> <span class="token keyword">column</span> test_column <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">desc</span> dept02<span class="token punctuation">;</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> emp01
    <span class="token keyword">add</span> <span class="token keyword">column</span> test_column <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">desc</span> emp01<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 10. 删除表emp01中的列department_id</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">alter</span> <span class="token keyword">table</span> emp01
    <span class="token keyword">drop</span> <span class="token keyword">column</span> department_id<span class="token punctuation">;</span>
<span class="token keyword">desc</span> emp01<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 11. 创建数据库test02_market</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">database</span> <span class="token keyword">if</span> <span class="token operator">not</span> <span class="token keyword">exists</span> test02_market<span class="token punctuation">;</span>
<span class="token keyword">show</span> <span class="token keyword">databases</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> test02_market<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 12. 创建数据表customers</p><table><thead><tr><th>字段名</th><th>类型</th></tr></thead><tbody><tr><td>c_num</td><td>int</td></tr><tr><td>c_name</td><td>varchar(50)</td></tr><tr><td>c_concat</td><td>varchar(50)</td></tr><tr><td>c_city</td><td>varchar(50)</td></tr><tr><td>c_birth</td><td>date</td></tr></tbody></table><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token operator">not</span> <span class="token keyword">exists</span> customers
<span class="token punctuation">(</span>
    c_num    <span class="token keyword">int</span><span class="token punctuation">,</span>
    c_name   <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    c_concat <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    c_city   <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    c_birth  <span class="token keyword">date</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">desc</span> customers<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 13. 将c_contact字段移动到c_birth字段后面</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">alter</span> <span class="token keyword">table</span> customers
    <span class="token keyword">modify</span> c_concat <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token keyword">after</span> c_birth<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 14. 将c_name字段数据类型改为varchar(70)</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">alter</span> <span class="token keyword">table</span> customers
    <span class="token keyword">modify</span> c_name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">desc</span> customers<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 15. 将c_concat字段改名为c_phone</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">alter</span> <span class="token keyword">table</span> customers <span class="token keyword">rename</span> <span class="token keyword">column</span> c_concat <span class="token keyword">to</span> c_phone<span class="token punctuation">;</span>
<span class="token keyword">desc</span> customers<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 16. 增加c_gender字段到c_name后面,数据类型为char(1)</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">alter</span> <span class="token keyword">table</span> customers
    <span class="token keyword">add</span> c_gender <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">after</span> c_name<span class="token punctuation">;</span>
<span class="token keyword">desc</span> customers<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 17. 将表名改为customers_info</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">rename</span> <span class="token keyword">table</span> customers <span class="token keyword">to</span> customers_info<span class="token punctuation">;</span>
<span class="token keyword">show</span> <span class="token keyword">tables</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 18. 删除字段_city</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">alter</span> <span class="token keyword">table</span> customers
    <span class="token keyword">drop</span> <span class="token keyword">column</span> c_city<span class="token punctuation">;</span>
<span class="token keyword">desc</span> customers<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="数据的处理-增删改" tabindex="-1"><a class="header-anchor" href="#数据的处理-增删改" aria-hidden="true">#</a> 数据的处理-增删改</h2><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">use</span> atguigudb<span class="token punctuation">;</span>
<span class="token keyword">show</span> <span class="token keyword">tables</span><span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> emp
<span class="token punctuation">(</span>
    id        <span class="token keyword">int</span><span class="token punctuation">,</span>
    name      <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    hire_date <span class="token keyword">date</span><span class="token punctuation">,</span>
    salary    <span class="token keyword">decimal</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">show</span> <span class="token keyword">tables</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="添加数据" tabindex="-1"><a class="header-anchor" href="#添加数据" aria-hidden="true">#</a> 添加数据</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- 方式1,按照表字段顺序添加</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> emp
<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&#39;Tom&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2021-11-11&#39;</span><span class="token punctuation">,</span> <span class="token number">3400.12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp<span class="token punctuation">;</span>
<span class="token comment">-- 方式2,没有赋值的字段值为null</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> emp<span class="token punctuation">(</span>id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> hire_date<span class="token punctuation">,</span> salary<span class="token punctuation">)</span>
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&#39;Jerry&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;1992-09-12&#39;</span><span class="token punctuation">,</span> <span class="token number">9999.99</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp<span class="token punctuation">;</span>
<span class="token comment">-- 方式3,同时插入多条</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> emp<span class="token punctuation">(</span>id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> hire_date<span class="token punctuation">,</span> salary<span class="token punctuation">)</span>
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">&#39;俊杰&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;1992-09-12&#39;</span><span class="token punctuation">,</span> <span class="token number">9999.99</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">&#39;德华&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;1992-09-12&#39;</span><span class="token punctuation">,</span> <span class="token number">9999.99</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp<span class="token punctuation">;</span>
<span class="token comment">-- 方式4,从其他表查询插入</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> emp<span class="token punctuation">(</span>id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> hire_date<span class="token punctuation">,</span> salary<span class="token punctuation">)</span>
<span class="token keyword">select</span> department_id<span class="token punctuation">,</span> last_name<span class="token punctuation">,</span> hire_date<span class="token punctuation">,</span> salary
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>employees<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="删除数据-某一行-或者多行" tabindex="-1"><a class="header-anchor" href="#删除数据-某一行-或者多行" aria-hidden="true">#</a> 删除数据,某一行,或者多行</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">delete</span>
<span class="token keyword">from</span> emp
<span class="token keyword">where</span> id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp<span class="token punctuation">;</span>
<span class="token keyword">delete</span>
<span class="token keyword">from</span> emp
<span class="token keyword">where</span> id <span class="token operator">is</span> <span class="token boolean">null</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp
<span class="token keyword">order</span> <span class="token keyword">by</span> id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="更新数据-更新数据" tabindex="-1"><a class="header-anchor" href="#更新数据-更新数据" aria-hidden="true">#</a> 更新数据/更新数据</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">update</span> emp
<span class="token keyword">set</span> hire_date <span class="token operator">=</span> curdate<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp
<span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token comment">-- 同时修改一行数据的多个字段</span>
<span class="token keyword">update</span> emp
<span class="token keyword">set</span> id   <span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span>
    name <span class="token operator">=</span><span class="token string">&#39;王&#39;</span>
<span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp
<span class="token keyword">order</span> <span class="token keyword">by</span> id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="计算列" tabindex="-1"><a class="header-anchor" href="#计算列" aria-hidden="true">#</a> 计算列</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> test
<span class="token punctuation">(</span>
    a <span class="token keyword">int</span><span class="token punctuation">,</span>
    b <span class="token keyword">int</span><span class="token punctuation">,</span>
    c <span class="token keyword">int</span> generated always <span class="token keyword">as</span> <span class="token punctuation">(</span>a <span class="token operator">+</span> b<span class="token punctuation">)</span> virtual <span class="token comment"># c为计算列</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> test<span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> test<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> test<span class="token punctuation">;</span>
<span class="token keyword">update</span> test
<span class="token keyword">set</span> b <span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> test<span class="token punctuation">;</span>

<span class="token keyword">drop</span> <span class="token keyword">table</span> test<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">show</span> <span class="token keyword">tables</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ddl-dml综合练习" tabindex="-1"><a class="header-anchor" href="#ddl-dml综合练习" aria-hidden="true">#</a> DDL DML综合练习</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- 1.创建数据库library</span>
<span class="token keyword">show</span> <span class="token keyword">databases</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> my_atguigudb<span class="token punctuation">;</span>
<span class="token keyword">show</span> <span class="token keyword">tables</span><span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">database</span> <span class="token keyword">if</span> <span class="token operator">not</span> <span class="token keyword">exists</span> library <span class="token keyword">character</span> <span class="token keyword">set</span> <span class="token string">&#39;utf8&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">show</span> <span class="token keyword">databases</span><span class="token punctuation">;</span>
<span class="token comment">-- 2.创建表books,表结构如下</span>
<span class="token keyword">use</span> library<span class="token punctuation">;</span>
<span class="token keyword">show</span> <span class="token keyword">tables</span><span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token operator">not</span> <span class="token keyword">exists</span> books
<span class="token punctuation">(</span>
    id       <span class="token keyword">int</span><span class="token punctuation">,</span>
    name     <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    authors  <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    price    <span class="token keyword">float</span><span class="token punctuation">,</span>
    pub_date <span class="token keyword">year</span><span class="token punctuation">,</span>
    note     <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    num      <span class="token keyword">int</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">desc</span> books<span class="token punctuation">;</span>
<span class="token comment">-- 3.插入数据</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> books <span class="token punctuation">(</span>id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> authors<span class="token punctuation">,</span> price<span class="token punctuation">,</span> pub_date<span class="token punctuation">,</span> note<span class="token punctuation">,</span> num<span class="token punctuation">)</span>
<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&#39;Tal of AAA&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Dickes&#39;</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">1995</span><span class="token punctuation">,</span> <span class="token string">&#39;novel&#39;</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&#39;EmmaT&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Jane lura&#39;</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">1993</span><span class="token punctuation">,</span> <span class="token string">&#39;joke&#39;</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">&#39;Story of Jane&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Jane Tim&#39;</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">2001</span><span class="token punctuation">,</span> <span class="token string">&#39;novel&#39;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">&#39;Lovey day&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Grorge Byron&#39;</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">2005</span><span class="token punctuation">,</span> <span class="token string">&#39;novel&#39;</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">&#39;Old land&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Honere Blade&#39;</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">2010</span><span class="token punctuation">,</span> <span class="token string">&#39;law&#39;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">&#39;The Battle&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Upton Sara&#39;</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">1999</span><span class="token punctuation">,</span> <span class="token string">&#39;medicine&#39;</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">&#39;Rose Hood&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Richard haggard&#39;</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">2008</span><span class="token punctuation">,</span> <span class="token string">&#39;cartoon&#39;</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> books<span class="token punctuation">;</span>

<span class="token comment">-- 4.将小说类型(novel) 的书的价格都增加5</span>
<span class="token keyword">update</span> books
<span class="token keyword">set</span> price <span class="token operator">=</span>price <span class="token operator">+</span> <span class="token number">5</span>
<span class="token keyword">where</span> note <span class="token operator">=</span> <span class="token string">&#39;novel&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> books<span class="token punctuation">;</span>

<span class="token comment">-- 5.将名称为EmmaT的书的价格改为40,并将说明改为drama</span>
<span class="token keyword">update</span> books
<span class="token keyword">set</span> price <span class="token operator">=</span> <span class="token number">40</span>
<span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">&#39;EmmaT&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> books
<span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">&#39;EmmaT&#39;</span><span class="token punctuation">;</span>

<span class="token comment">-- 6.删除库存为0的记录</span>
<span class="token keyword">delete</span>
<span class="token keyword">from</span> books
<span class="token keyword">where</span> num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> books<span class="token punctuation">;</span>

<span class="token comment">-- 7.统计书名中包含字母a字母的书</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> books
<span class="token keyword">where</span> name <span class="token operator">like</span> <span class="token string">&#39;%a%&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> books
<span class="token keyword">where</span> name <span class="token operator">like</span> <span class="token string">&#39;%a%&#39;</span><span class="token punctuation">;</span>
<span class="token comment">-- 8.统计书名中包含字母a的书的数量和库存总量</span>
<span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token string">&#39;库存总量&#39;</span>
<span class="token keyword">from</span> books
<span class="token keyword">where</span> name <span class="token operator">like</span> <span class="token string">&#39;%a%&#39;</span><span class="token punctuation">;</span>
<span class="token comment">-- 9.找出&#39;novel&#39;类型的书,按照价格降序排序</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> books
<span class="token keyword">where</span> note <span class="token operator">=</span> <span class="token string">&#39;novel&#39;</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> price <span class="token keyword">desc</span><span class="token punctuation">;</span>
<span class="token comment">-- 10.查询图书信息,按照库存量降序排序,如果库存量相同按照note升序排序</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> books
<span class="token keyword">order</span> <span class="token keyword">by</span> num <span class="token keyword">desc</span><span class="token punctuation">,</span> note <span class="token keyword">asc</span><span class="token punctuation">;</span>
<span class="token comment">-- 11.按照note分类统计书的数量</span>
<span class="token keyword">select</span> note<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> books
<span class="token keyword">group</span> <span class="token keyword">by</span> note<span class="token punctuation">;</span>
<span class="token comment">-- 12.按照note分类统计书的库存量,显示库存超过30本的</span>
<span class="token keyword">select</span> note<span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span>
<span class="token keyword">from</span> books
<span class="token keyword">group</span> <span class="token keyword">by</span> note
<span class="token keyword">having</span> <span class="token function">sum</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">30</span><span class="token punctuation">;</span>

<span class="token comment">-- 13.查询所有图书,每页显示5本,显示第二页</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> books
<span class="token keyword">limit</span> <span class="token number">5</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">;</span>

<span class="token comment">-- 14.按照note分类统计书的库存量,显示库存量最多的</span>
<span class="token keyword">select</span> note<span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span>
<span class="token keyword">from</span> books
<span class="token keyword">group</span> <span class="token keyword">by</span> note
<span class="token keyword">having</span> <span class="token function">sum</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token keyword">all</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">sum</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span>
                        <span class="token keyword">from</span> books
                        <span class="token keyword">group</span> <span class="token keyword">by</span> note<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">select</span> note<span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span>
<span class="token keyword">from</span> books
<span class="token keyword">group</span> <span class="token keyword">by</span> note
<span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token function">sum</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token keyword">desc</span>
<span class="token keyword">limit</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">;</span>

<span class="token comment">-- 15.查询书名达到10个字符的书,不包括里面的空格</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> books
<span class="token keyword">where</span> char_length<span class="token punctuation">(</span><span class="token keyword">replace</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token string">&#39; &#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">10</span><span class="token punctuation">;</span>

<span class="token comment">-- 16.查询书名和类型,其中note值为novel显示小说,law显示法律,medicine显示医药,</span>
<span class="token comment">-- cartoon显示卡通,joke显示笑话</span>
<span class="token keyword">select</span> name<span class="token punctuation">,</span>
       note<span class="token punctuation">,</span>
       <span class="token keyword">case</span>
           <span class="token keyword">when</span> note <span class="token operator">=</span> <span class="token string">&#39;novel&#39;</span> <span class="token keyword">then</span> <span class="token string">&#39;小说&#39;</span>
           <span class="token keyword">when</span> note <span class="token operator">=</span> <span class="token string">&#39;law&#39;</span> <span class="token keyword">then</span> <span class="token string">&#39;法律&#39;</span>
           <span class="token keyword">when</span> note <span class="token operator">=</span> <span class="token string">&#39;medicine&#39;</span> <span class="token keyword">then</span> <span class="token string">&#39;医药&#39;</span>
           <span class="token keyword">when</span> note <span class="token operator">=</span> <span class="token string">&#39;cartoon&#39;</span> <span class="token keyword">then</span> <span class="token string">&#39;卡通&#39;</span>
           <span class="token keyword">when</span> note <span class="token operator">=</span> <span class="token string">&#39;joke&#39;</span> <span class="token keyword">then</span> <span class="token string">&#39;笑话&#39;</span>
           <span class="token keyword">else</span> <span class="token string">&#39;其他&#39;</span>
           <span class="token keyword">end</span>
<span class="token keyword">from</span> books<span class="token punctuation">;</span>
<span class="token comment">-- 17.查询书名,库存,其中num值超过30本的,显示滞销,大于0,并低于10的显示畅销,为0的显示无库存</span>
<span class="token keyword">select</span> name<span class="token punctuation">,</span>
       num<span class="token punctuation">,</span>
       <span class="token keyword">case</span> num
           <span class="token keyword">when</span> num <span class="token operator">&gt;</span> <span class="token number">10</span> <span class="token keyword">then</span> <span class="token string">&#39;滞销&#39;</span>
           <span class="token keyword">when</span> num <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">and</span> num <span class="token operator">&lt;</span> <span class="token number">10</span> <span class="token keyword">then</span> <span class="token string">&#39;畅销&#39;</span>
           <span class="token keyword">when</span> num <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">then</span> <span class="token string">&#39;无库存&#39;</span>
           <span class="token keyword">else</span> <span class="token string">&#39;其他&#39;</span>
           <span class="token keyword">end</span> <span class="token keyword">as</span> <span class="token string">&#39;状态&#39;</span>
<span class="token keyword">from</span> books<span class="token punctuation">;</span>
<span class="token comment">-- 18.统计每一种note的库存量,并合计总量</span>
<span class="token keyword">select</span> ifnull<span class="token punctuation">(</span>note<span class="token punctuation">,</span> <span class="token string">&#39;总库存&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span>
<span class="token keyword">from</span> books
<span class="token keyword">group</span> <span class="token keyword">by</span> note
<span class="token keyword">with rollup</span><span class="token punctuation">;</span>
<span class="token comment">-- 19. 统计每一种note的数量,并合计总量</span>
<span class="token keyword">select</span> ifnull<span class="token punctuation">(</span>note<span class="token punctuation">,</span> <span class="token string">&#39;总量&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token string">&#39;数量&#39;</span>
<span class="token keyword">from</span> books
<span class="token keyword">group</span> <span class="token keyword">by</span> note
<span class="token keyword">with rollup</span><span class="token punctuation">;</span>

<span class="token comment">-- 20.统计库存量前三名的图书</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> books
<span class="token keyword">order</span> <span class="token keyword">by</span> num <span class="token keyword">desc</span>
<span class="token keyword">limit</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">;</span>

<span class="token comment">-- 21,找出最早出版的一本书</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> books
<span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token keyword">year</span><span class="token punctuation">(</span>pub_date<span class="token punctuation">)</span>
<span class="token keyword">limit</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">;</span>

<span class="token comment">-- 22.找出novel中价格最高的一本书</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> books
<span class="token keyword">order</span> <span class="token keyword">by</span> price <span class="token keyword">desc</span>
<span class="token keyword">limit</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">;</span>

<span class="token comment">-- 23.找出书名中字数最多的一本书,不含空格</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> books
<span class="token keyword">order</span> <span class="token keyword">by</span> char_length<span class="token punctuation">(</span><span class="token keyword">replace</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token string">&#39; &#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">desc</span>
<span class="token keyword">limit</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="数据处理之增删改" tabindex="-1"><a class="header-anchor" href="#数据处理之增删改" aria-hidden="true">#</a> 数据处理之增删改</h2><p>select database(); show tables;</p><h3 id="练习-9" tabindex="-1"><a class="header-anchor" href="#练习-9" aria-hidden="true">#</a> 练习</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- 1.创建数据库dbtest11</span>
<span class="token keyword">create</span> <span class="token keyword">database</span> <span class="token keyword">if</span> <span class="token operator">not</span> <span class="token keyword">exists</span> db_test_11 <span class="token keyword">character</span> <span class="token keyword">set</span> <span class="token string">&#39;utf8&#39;</span><span class="token punctuation">;</span>
<span class="token comment">-- 2.运行以下脚本创建表my_employees;</span>
<span class="token keyword">use</span> db_test_11<span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token operator">not</span> <span class="token keyword">exists</span> my_employees
<span class="token punctuation">(</span>
    id         <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    first_name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    last_name  <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    user_id    <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    salary     <span class="token keyword">double</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">desc</span> my_employees<span class="token punctuation">;</span>

<span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token operator">not</span> <span class="token keyword">exists</span> users
<span class="token punctuation">(</span>
    id            <span class="token keyword">int</span><span class="token punctuation">,</span>
    user_id       <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    department_id <span class="token keyword">int</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">desc</span> users<span class="token punctuation">;</span>

<span class="token comment">-- 3.显示表my_employees的结构</span>
<span class="token keyword">desc</span> my_employees<span class="token punctuation">;</span>
<span class="token comment">-- 4.向my_employees表中插入下列数据</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> my_employees<span class="token punctuation">(</span>id<span class="token punctuation">,</span> first_name<span class="token punctuation">,</span> last_name<span class="token punctuation">,</span> user_id<span class="token punctuation">,</span> salary<span class="token punctuation">)</span>
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&#39;patel&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Ralph&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Rpatel&#39;</span><span class="token punctuation">,</span> <span class="token number">896</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&#39;Dancs&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Betty&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Bdancs&#39;</span><span class="token punctuation">,</span> <span class="token number">860</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">&#39;Biri&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Ben&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Bbiri&#39;</span><span class="token punctuation">,</span> <span class="token number">1100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">&#39;Newman&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Chad&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Cnewman&#39;</span><span class="token punctuation">,</span> <span class="token number">750</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">&#39;Kopeburn&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Audrey&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Aropebur&#39;</span><span class="token punctuation">,</span> <span class="token number">1550</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> my_employees<span class="token punctuation">;</span>

<span class="token comment">-- 5.向users表中插入数据</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> users <span class="token punctuation">(</span>id<span class="token punctuation">,</span> user_id<span class="token punctuation">,</span> department_id<span class="token punctuation">)</span>
<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&#39;Rpatel&#39;</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&#39;Bdancs&#39;</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">&#39;Bbiri&#39;</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">&#39;Cnewman&#39;</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">&#39;Aropebur&#39;</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> users<span class="token punctuation">;</span>
<span class="token comment">-- 6.将3号员工的last_name修改为&#39;drelxer&#39;</span>
<span class="token keyword">update</span> my_employees
<span class="token keyword">set</span> last_name <span class="token operator">=</span><span class="token string">&#39;drelxer&#39;</span>
<span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> my_employees<span class="token punctuation">;</span>

<span class="token comment">--  7. 将所有工资少于900的员工的工资修改为1000</span>
<span class="token keyword">update</span> my_employees
<span class="token keyword">set</span> salary <span class="token operator">=</span><span class="token number">1000</span>
<span class="token keyword">where</span> salary <span class="token operator">&lt;</span> <span class="token number">900</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> my_employees<span class="token punctuation">;</span>

<span class="token comment">-- 8.将user_id为Bbiri的user表和my_employees表的记录全部删除</span>
<span class="token keyword">delete</span>
<span class="token keyword">from</span> users
<span class="token keyword">where</span> user_id <span class="token operator">=</span> <span class="token string">&#39;Bbiri&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">delete</span>
<span class="token keyword">from</span> my_employees
<span class="token keyword">where</span> user_id <span class="token operator">=</span> <span class="token string">&#39;Bbiri&#39;</span><span class="token punctuation">;</span>

<span class="token comment">-- 方式二</span>
<span class="token keyword">delete</span> m<span class="token punctuation">,</span>u
<span class="token keyword">from</span> my_employees m
         <span class="token keyword">join</span> users u
              <span class="token keyword">on</span> m<span class="token punctuation">.</span>user_id <span class="token operator">=</span> u<span class="token punctuation">.</span>user_id
<span class="token keyword">where</span> m<span class="token punctuation">.</span>user_id <span class="token operator">=</span> <span class="token string">&#39;Bbiri&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> users<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> my_employees<span class="token punctuation">;</span>

<span class="token comment">-- 9.删除my_employees,users表中所有的数据</span>
<span class="token keyword">delete</span>
<span class="token keyword">from</span> my_employees<span class="token punctuation">;</span>
<span class="token keyword">delete</span>
<span class="token keyword">from</span> users<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> users<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> my_employees<span class="token punctuation">;</span>
<span class="token comment">-- 10.检查所做的修正</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> users<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> my_employees<span class="token punctuation">;</span>
<span class="token comment">-- 11.清空表my_employees</span>
<span class="token keyword">truncate</span> <span class="token keyword">table</span> my_employees<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="练习2" tabindex="-1"><a class="header-anchor" href="#练习2" aria-hidden="true">#</a> 练习2</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- 1.使用现有数据库</span>
<span class="token keyword">use</span> db_test_11<span class="token punctuation">;</span>
<span class="token comment">-- 2.创建表pet</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> pet
<span class="token punctuation">(</span>
    name    <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">&#39;宠物名称&#39;</span><span class="token punctuation">,</span>
    owner   <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">&#39;宠物主人&#39;</span><span class="token punctuation">,</span>
    species <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">&#39;种类&#39;</span><span class="token punctuation">,</span>
    sex     <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">&#39;性别&#39;</span><span class="token punctuation">,</span>
    birth   <span class="token keyword">Year</span> <span class="token keyword">comment</span> <span class="token string">&#39;出生日期&#39;</span><span class="token punctuation">,</span>
    death   <span class="token keyword">YEAR</span> <span class="token keyword">comment</span> <span class="token string">&#39;死亡日期&#39;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">desc</span> pet<span class="token punctuation">;</span>
<span class="token keyword">show</span> <span class="token keyword">full</span> <span class="token keyword">columns</span> <span class="token keyword">from</span> pet<span class="token punctuation">;</span>
<span class="token comment">-- 3.添加记录</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> pet <span class="token punctuation">(</span>name<span class="token punctuation">,</span> owner<span class="token punctuation">,</span> species<span class="token punctuation">,</span> sex<span class="token punctuation">,</span> birth<span class="token punctuation">,</span> death<span class="token punctuation">)</span>
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;Fluffy&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;harold&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Cat&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;f&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2003&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2010&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token string">&#39;Claws&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;gwen&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Cat&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;m&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2004&#39;</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token string">&#39;Buffy&#39;</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token string">&#39;Dog&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;f&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2009&#39;</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token string">&#39;Fang&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;benny&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Dog&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;m&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2000&#39;</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token string">&#39;bowser&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;diane&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Dog&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;m&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2003&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2009&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token string">&#39;Chirpy&#39;</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token string">&#39;Bird&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;f&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2008&#39;</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> pet<span class="token punctuation">;</span>
<span class="token comment">-- 4.添加字段:主人的生日owner_birth DATE类型</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> pet
    <span class="token keyword">add</span> owner_birth <span class="token keyword">date</span><span class="token punctuation">;</span>
<span class="token keyword">desc</span> pet<span class="token punctuation">;</span>
<span class="token comment">-- 5.将名称为Claws的猫的主人改为kevin</span>
<span class="token keyword">update</span> pet
<span class="token keyword">set</span> owner <span class="token operator">=</span> <span class="token string">&#39;kevin&#39;</span>
<span class="token keyword">where</span> species <span class="token operator">=</span> <span class="token string">&#39;Cat&#39;</span>
  <span class="token operator">and</span> name <span class="token operator">=</span> <span class="token string">&#39;Claws&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> pet<span class="token punctuation">;</span>

<span class="token comment">-- 6.将没有死的狗的主人改为duck</span>
<span class="token keyword">update</span> pet
<span class="token keyword">set</span> owner <span class="token operator">=</span> <span class="token string">&#39;duck&#39;</span>
<span class="token keyword">where</span> death <span class="token operator">is</span> <span class="token boolean">null</span>
  <span class="token operator">and</span> species <span class="token operator">=</span> <span class="token string">&#39;Dog&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> pet<span class="token punctuation">;</span>

<span class="token comment">-- 7.查询没有主人的宠物的名字</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> pet
<span class="token keyword">where</span> owner <span class="token operator">is</span> <span class="token boolean">null</span><span class="token punctuation">;</span>

<span class="token comment">-- 8.查询已经死了的cat的姓名,主人,以及去世时间</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> pet
<span class="token keyword">where</span> species <span class="token operator">=</span> <span class="token string">&#39;Cat&#39;</span>
  <span class="token operator">and</span> death <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">;</span>

<span class="token comment">-- 9.查询已经死亡的狗</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> pet
<span class="token keyword">where</span> species <span class="token operator">=</span> <span class="token string">&#39;Dog&#39;</span>
  <span class="token operator">and</span> death <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">;</span>

<span class="token comment">-- 10.查询所有的宠物信息</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> pet<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="练习3" tabindex="-1"><a class="header-anchor" href="#练习3" aria-hidden="true">#</a> 练习3</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- 1.使用数据库db_test_11</span>
<span class="token keyword">select</span> <span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> db_test_11<span class="token punctuation">;</span>
<span class="token comment">-- 2.创建表employees,并添加记录</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token operator">not</span> <span class="token keyword">exists</span> employees
<span class="token punctuation">(</span>
    id     <span class="token keyword">int</span><span class="token punctuation">,</span>
    name   <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    sex    <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    tel    <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    addr   <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    salary <span class="token keyword">double</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">desc</span> employees<span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> db_test_11<span class="token punctuation">.</span>employees<span class="token punctuation">(</span>id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> sex<span class="token punctuation">,</span> tel<span class="token punctuation">,</span> addr<span class="token punctuation">,</span> salary<span class="token punctuation">)</span>
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">10001</span><span class="token punctuation">,</span> <span class="token string">&#39;张一一&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;男&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;1357777345&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;山东青岛&#39;</span><span class="token punctuation">,</span> <span class="token number">1001.58</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token number">10002</span><span class="token punctuation">,</span> <span class="token string">&#39;刘小红&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;女&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;13477879867&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;河北保定&#39;</span><span class="token punctuation">,</span> <span class="token number">1201.21</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token number">10003</span><span class="token punctuation">,</span> <span class="token string">&#39;李四&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;男&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;0751-1234567&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;广东佛山&#39;</span><span class="token punctuation">,</span> <span class="token number">1004.11</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token number">10004</span><span class="token punctuation">,</span> <span class="token string">&#39;刘小强&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;男&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;0755-5555555&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;广东深圳&#39;</span><span class="token punctuation">,</span> <span class="token number">1501.23</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token number">10005</span><span class="token punctuation">,</span> <span class="token string">&#39;王艳&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;女&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;020-1232133&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;广东广州&#39;</span><span class="token punctuation">,</span> <span class="token number">1405.16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> employees<span class="token punctuation">;</span>
<span class="token comment">-- 3. 查询出薪资在1200-1300之间的员工向信息</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> salary <span class="token operator">between</span> <span class="token number">1200</span> <span class="token operator">and</span> <span class="token number">1300</span><span class="token punctuation">;</span>
<span class="token comment">-- 4.查询出姓&quot;刘&quot;的员工的工号,姓名,家庭住址</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> <span class="token identifier"><span class="token punctuation">\`</span>name<span class="token punctuation">\`</span></span> <span class="token operator">like</span> <span class="token string">&#39;刘%&#39;</span><span class="token punctuation">;</span>
<span class="token comment">-- 5.将李四的家庭地址改为广东韶关</span>
<span class="token keyword">update</span> employees
<span class="token keyword">set</span> addr <span class="token operator">=</span><span class="token string">&#39;广东韶关&#39;</span>
<span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">&#39;李四&#39;</span><span class="token punctuation">;</span>

<span class="token comment">-- 6.查询名字中带&#39;小&#39;的员工</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> name <span class="token operator">like</span> <span class="token string">&#39;%小%&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="数据类型概述" tabindex="-1"><a class="header-anchor" href="#数据类型概述" aria-hidden="true">#</a> 数据类型概述</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- 1.创建数据库指定字符集</span>
<span class="token keyword">create</span> <span class="token keyword">database</span> <span class="token keyword">if</span> <span class="token operator">not</span> <span class="token keyword">exists</span> db_test_11 <span class="token keyword">character</span> <span class="token keyword">set</span> <span class="token string">&#39;utf8&#39;</span><span class="token punctuation">;</span>
<span class="token comment">-- 2.整形数据类型</span>
<span class="token keyword">use</span> db_test_11<span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token operator">not</span> <span class="token keyword">exists</span> test_int1
<span class="token punctuation">(</span>
    f1 <span class="token keyword">tinyint</span><span class="token punctuation">,</span>
    f2 <span class="token keyword">smallint</span><span class="token punctuation">,</span>
    f3 <span class="token keyword">mediumint</span><span class="token punctuation">,</span>
    f4 <span class="token keyword">int</span><span class="token punctuation">,</span>
    f5 <span class="token keyword">bigint</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">desc</span> test_int1<span class="token punctuation">;</span>

<span class="token comment">-- 定点数decimal ,解决浮点数精度问题.高精度小时,decimal(M,D),M精度,D标度</span>
<span class="token keyword">show</span> <span class="token keyword">tables</span><span class="token punctuation">;</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> employees
    <span class="token keyword">add</span> create_time <span class="token keyword">timestamp</span><span class="token punctuation">;</span>
<span class="token keyword">desc</span> employees<span class="token punctuation">;</span>
<span class="token comment">-- 获取时间戳</span>
<span class="token keyword">select</span> unix_timestamp<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 外键约束</span>
<span class="token comment">-- 先创建主表</span>
<span class="token keyword">show</span> <span class="token keyword">tables</span><span class="token punctuation">;</span>
<span class="token keyword">show</span> <span class="token keyword">databases</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> db_test_11<span class="token punctuation">;</span>
<span class="token keyword">show</span> <span class="token keyword">tables</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> employees<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> my_employees<span class="token punctuation">;</span>

<span class="token keyword">drop</span> <span class="token keyword">table</span> my_employees<span class="token punctuation">;</span>
<span class="token keyword">show</span> <span class="token keyword">tables</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>创建主表</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token operator">not</span> <span class="token keyword">exists</span> my_departments
<span class="token punctuation">(</span>
    department_id   <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>
    department_name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>再创建从表</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token operator">not</span> <span class="token keyword">exists</span> my_employees
<span class="token punctuation">(</span>
    employee_id   <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>
    employee_name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    department_id <span class="token keyword">int</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>表级约束</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">constraint</span> fk_empl_dept_id <span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>department_id<span class="token punctuation">)</span> <span class="token keyword">references</span> my_departments <span class="token punctuation">(</span>department_id<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>department_id<span class="token punctuation">)</span> <span class="token keyword">references</span> my_departments <span class="token punctuation">(</span>department_id<span class="token punctuation">)</span> <span class="token keyword">on</span> <span class="token keyword">update</span> <span class="token keyword">cascade</span> <span class="token keyword">on</span> <span class="token keyword">delete</span> <span class="token keyword">set</span> <span class="token boolean">null</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">desc</span> my_employees<span class="token punctuation">;</span>
<span class="token keyword">desc</span> my_departments<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 查询所有约束</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> information_schema<span class="token punctuation">.</span>TABLE_CONSTRAINTS
<span class="token keyword">where</span> TABLE_NAME <span class="token operator">=</span> <span class="token string">&#39;my_employees&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 先在主表插入数据</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">insert</span> <span class="token keyword">into</span> my_departments <span class="token punctuation">(</span>department_id<span class="token punctuation">,</span> department_name<span class="token punctuation">)</span>
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">&#39;IT&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> my_departments<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 再在从表插入数据</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">insert</span> <span class="token keyword">into</span> my_employees<span class="token punctuation">(</span>employee_id<span class="token punctuation">,</span> employee_name<span class="token punctuation">,</span> department_id<span class="token punctuation">)</span>
<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token string">&#39;宋红康&#39;</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> my_employees<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 删除数据要先删除从表的数据,再删除主表数据</p><p>-- 外键同步更新/删除 ,建议使用同步更新,并且使用&#39;on update cascade on delete restrict &#39;</p><p>从表中设置</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>department_id<span class="token punctuation">)</span> <span class="token keyword">references</span>  my_departments<span class="token punctuation">(</span>department_id<span class="token punctuation">)</span> <span class="token keyword">on</span> <span class="token keyword">update</span> <span class="token keyword">cascade</span> <span class="token keyword">on</span> <span class="token keyword">delete</span> <span class="token keyword">set</span> <span class="token boolean">null</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>示例: 从表</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">drop</span> <span class="token keyword">table</span> my_employees<span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token operator">not</span> <span class="token keyword">exists</span> my_employees
<span class="token punctuation">(</span>
    employee_id   <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>
    employee_name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    department_id <span class="token keyword">int</span><span class="token punctuation">,</span>
<span class="token comment">#表级约束,外键同步更新/删除</span>
<span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>department_id<span class="token punctuation">)</span> <span class="token keyword">references</span> my_departments <span class="token punctuation">(</span>department_id<span class="token punctuation">)</span> <span class="token keyword">on</span> <span class="token keyword">update</span> <span class="token keyword">cascade</span> <span class="token keyword">on</span> <span class="token keyword">delete</span> <span class="token keyword">set</span> <span class="token boolean">null</span><span class="token punctuation">,</span>
<span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>department_id<span class="token punctuation">)</span> <span class="token keyword">references</span> my_departments <span class="token punctuation">(</span>department_id<span class="token punctuation">)</span> <span class="token keyword">on</span> <span class="token keyword">update</span> <span class="token keyword">cascade</span> <span class="token keyword">on</span> <span class="token keyword">delete</span> <span class="token keyword">restrict</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 删除外键约束</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> information_schema<span class="token punctuation">.</span>TABLE_CONSTRAINTS
<span class="token keyword">where</span> TABLE_NAME <span class="token operator">=</span> <span class="token string">&#39;my_employees&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> my_employees
    <span class="token keyword">drop</span> <span class="token keyword">foreign</span> <span class="token keyword">key</span> fk_empl_dept_id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-- 查看表的索引</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">show</span> <span class="token keyword">index</span> <span class="token keyword">from</span> my_employees<span class="token punctuation">;</span>

<span class="token keyword">alter</span> <span class="token keyword">table</span>  my_employees <span class="token keyword">drop</span> <span class="token keyword">index</span> <span class="token operator">&lt;</span>索引名<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="练习-10" tabindex="-1"><a class="header-anchor" href="#练习-10" aria-hidden="true">#</a> 练习</h2><p>已经存在数据库test04_emp，两张表emp2和dept2</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> test04_emp<span class="token punctuation">;</span>
<span class="token keyword">use</span> test04_emp<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> emp2
<span class="token punctuation">(</span>
    id       <span class="token keyword">INT</span><span class="token punctuation">,</span>
    emp_name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> dept2
<span class="token punctuation">(</span>
    id        <span class="token keyword">INT</span><span class="token punctuation">,</span>
    dept_name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- 1. 向表emp2的id列中添加PRIMARY KEY约束</span>

<span class="token keyword">alter</span> <span class="token keyword">table</span> emp2
    <span class="token keyword">modify</span> id <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">;</span>

<span class="token keyword">alter</span> <span class="token keyword">table</span> emp2
    <span class="token keyword">add</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">desc</span> emp2<span class="token punctuation">;</span>

<span class="token comment">-- 2. 向表dept2的id列中添加PRIMARY KEY约束</span>

<span class="token keyword">alter</span> <span class="token keyword">table</span> dept2
    <span class="token keyword">modify</span> id <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">;</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> dept2
    <span class="token keyword">add</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">desc</span> dept2<span class="token punctuation">;</span>

<span class="token comment">-- 3. 向表emp2中添加列dept_id，并在其中定义FOREIGN KEY约束，与之相关联的列是dept2表中的id列。</span>

<span class="token keyword">alter</span> <span class="token keyword">table</span> emp2
    <span class="token keyword">add</span> <span class="token keyword">column</span> dept_id <span class="token keyword">int</span><span class="token punctuation">;</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> emp2
    <span class="token keyword">add</span> <span class="token keyword">constraint</span> fk_emp2_dept_id <span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>dept_id<span class="token punctuation">)</span> <span class="token keyword">references</span> dept2 <span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> information_schema<span class="token punctuation">.</span>TABLE_CONSTRAINTS
<span class="token keyword">where</span> TABLE_NAME <span class="token operator">=</span> <span class="token string">&#39;emp2&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>练习2</p><blockquote><p>承接《第11章_数据处理之增删改》的综合案例。</p></blockquote><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- 1、创建数据库test01_library</span>

<span class="token keyword">create</span> <span class="token keyword">database</span> <span class="token keyword">if</span> <span class="token operator">not</span> <span class="token keyword">exists</span> test01_library <span class="token keyword">character</span> <span class="token keyword">set</span> <span class="token string">&#39;utf8&#39;</span><span class="token punctuation">;</span>

<span class="token comment">-- 2、创建表 books，表结构如下：</span>

<span class="token keyword">use</span> test01_library<span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token operator">not</span> <span class="token keyword">exists</span> books
<span class="token punctuation">(</span>
    id      <span class="token keyword">int</span><span class="token punctuation">,</span>
    name    <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    authors <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    price   <span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    pubdate <span class="token keyword">year</span><span class="token punctuation">,</span>
    note    <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    num     <span class="token keyword">int</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">desc</span> books<span class="token punctuation">;</span>

<span class="token comment">-- 3、使用ALTER语句给books按如下要求增加相应的约束</span>

<span class="token keyword">alter</span> <span class="token keyword">table</span> books
    <span class="token keyword">modify</span> id <span class="token keyword">int</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span> <span class="token keyword">unique</span><span class="token punctuation">;</span>
<span class="token keyword">desc</span> books<span class="token punctuation">;</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> books
    <span class="token keyword">modify</span> name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">;</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> books
    <span class="token keyword">modify</span> authors <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">;</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> books
    <span class="token keyword">modify</span> price <span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">;</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> books
    <span class="token keyword">modify</span> pubdate <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">;</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> books
    <span class="token keyword">modify</span> num <span class="token keyword">int</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>练习3</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">#1. 创建数据库test04_company</span>
<span class="token keyword">create</span> <span class="token keyword">database</span> <span class="token keyword">if</span> <span class="token operator">not</span> <span class="token keyword">exists</span> test04_company <span class="token keyword">character</span> <span class="token keyword">set</span> <span class="token string">&#39;utf8&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">use</span><span class="token punctuation">;</span>
<span class="token comment">#2. 按照下表给出的表结构在test04_company数据库中创建两个数据表offices和employees</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token operator">not</span> <span class="token keyword">exists</span> offices
<span class="token punctuation">(</span>
    officeCode <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">unique</span><span class="token punctuation">,</span>
    city       <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>         <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>
    address    <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    country    <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>         <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>
    postalCode <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token keyword">unique</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">desc</span> offices<span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token operator">not</span> <span class="token keyword">exists</span> employees
<span class="token punctuation">(</span>
    employeeNumber <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">unique</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>
    last_name      <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>         <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>
    first_name     <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>         <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>
    mobile         <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span> <span class="token keyword">unique</span><span class="token punctuation">,</span>
    officeCode     <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">unique</span><span class="token punctuation">,</span>
    job_title      <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>         <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>
    birth          <span class="token keyword">datetime</span>            <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>
    note           <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    sex            <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">constraint</span> fk_employees_officeCode <span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>officeCode<span class="token punctuation">)</span> <span class="token keyword">references</span> offices <span class="token punctuation">(</span>officeCode<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">#3. 将表employees的mobile字段修改到officeCode字段后面 #</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> employees
    <span class="token keyword">modify</span> mobile <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span> <span class="token keyword">unique</span> <span class="token keyword">after</span> officeCode<span class="token punctuation">;</span>
<span class="token keyword">desc</span> employees<span class="token punctuation">;</span>

<span class="token comment">-- 4. 将表employees的birth字段改名为employee_birth</span>

<span class="token keyword">alter</span> <span class="token keyword">table</span> employees
    <span class="token keyword">modify</span> employee_birth <span class="token keyword">datetime</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">;</span>

<span class="token comment">-- 5. 修改sex字段，数据类型为CHAR(1)，非空约束</span>

<span class="token keyword">alter</span> <span class="token keyword">table</span> employees
    <span class="token keyword">modify</span> sex <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">;</span>

<span class="token comment">-- 6. 删除字段note</span>

<span class="token keyword">alter</span> <span class="token keyword">table</span> employees
    <span class="token keyword">drop</span> <span class="token keyword">column</span> note<span class="token punctuation">;</span>

<span class="token comment">-- 7. 增加字段名favorite_activity，数据类型为VARCHAR(100)</span>

<span class="token keyword">alter</span> <span class="token keyword">table</span> employees
    <span class="token keyword">add</span> favorite_activity <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 8. 将表employees名称修改为employees_info</span>

<span class="token keyword">alter</span> <span class="token keyword">table</span> employees <span class="token keyword">rename</span> employees_info<span class="token punctuation">;</span>

<span class="token keyword">alter</span> <span class="token keyword">table</span> employees_info <span class="token keyword">rename</span> employees<span class="token punctuation">;</span>

<span class="token keyword">desc</span> employees_info<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="视图" tabindex="-1"><a class="header-anchor" href="#视图" aria-hidden="true">#</a> 视图</h2><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">show</span> <span class="token keyword">tables</span><span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">view</span> view_emp
<span class="token keyword">as</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> employees<span class="token punctuation">;</span>

<span class="token keyword">show</span> <span class="token keyword">databases</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> my_atguigudb<span class="token punctuation">;</span>
<span class="token keyword">show</span> <span class="token keyword">tables</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> employees<span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">view</span> v_employees <span class="token keyword">as</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> employees<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> v_employees<span class="token punctuation">;</span>

<span class="token keyword">desc</span> employees<span class="token punctuation">;</span>
<span class="token keyword">update</span> employees
<span class="token keyword">set</span> phone_number <span class="token operator">=</span> <span class="token string">&#39;5386112&#39;</span>
<span class="token keyword">where</span> employee_id <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>

<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> employee_id <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> v_employees
<span class="token keyword">where</span> employee_id <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>

<span class="token keyword">create</span> <span class="token keyword">view</span> v1_employees<span class="token punctuation">(</span>id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> year_salary<span class="token punctuation">)</span> <span class="token keyword">as</span>
<span class="token keyword">select</span> department_id<span class="token punctuation">,</span> last_name<span class="token punctuation">,</span> salary <span class="token operator">*</span> <span class="token number">12</span>
<span class="token keyword">from</span> employees<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> v1_employees<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>针对多表</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">show</span> <span class="token keyword">tables</span><span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> departments <span class="token keyword">as</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> atguigudb<span class="token punctuation">.</span>departments<span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">view</span> v_empl_dept <span class="token keyword">as</span>
<span class="token keyword">select</span> department_name<span class="token punctuation">,</span> last_name
<span class="token keyword">from</span> employees <span class="token keyword">as</span> e
         <span class="token keyword">join</span> departments <span class="token keyword">as</span> d
              <span class="token keyword">on</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> v_empl_dept<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>利用视图对数据进行格式化</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">view</span> v1_empl_dept<span class="token punctuation">(</span>name<span class="token punctuation">,</span> department_id<span class="token punctuation">,</span> department_name<span class="token punctuation">)</span> <span class="token keyword">as</span>
<span class="token keyword">select</span> concat_ws<span class="token punctuation">(</span><span class="token string">&#39;,&#39;</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span>first_name<span class="token punctuation">,</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">)</span> <span class="token keyword">as</span> name<span class="token punctuation">,</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">,</span> department_name
<span class="token keyword">from</span> employees <span class="token keyword">as</span> e
         <span class="token keyword">join</span> departments <span class="token keyword">as</span> d
              <span class="token keyword">on</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id
<span class="token keyword">where</span> e<span class="token punctuation">.</span>department_id <span class="token operator">&gt;</span> <span class="token number">80</span><span class="token punctuation">;</span>

<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> v1_empl_dept<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>基于视图创建视图</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">view</span> v2_empt_dept <span class="token keyword">as</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> v1_empl_dept<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> v2_empt_dept<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>查看视图结构</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">desc</span> v2_empt_dept<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>查看视图属性信息</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">show</span> <span class="token keyword">table</span> <span class="token keyword">status</span> <span class="token operator">like</span> <span class="token string">&#39;v2_empt_dept&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>查看视图定义信息</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">show</span> <span class="token keyword">create</span> <span class="token keyword">view</span> v2_empt_dept<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>修改和删除视图中的数据,不建议更新和删除视图中的数据</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- 可以更新</span>

<span class="token keyword">update</span> v2_empt_dept
<span class="token keyword">set</span> department_id <span class="token operator">=</span><span class="token number">100</span>
<span class="token keyword">where</span> department_id <span class="token operator">=</span> <span class="token number">90</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> v2_empt_dept<span class="token punctuation">;</span>

<span class="token comment">-- 更新失败</span>

<span class="token keyword">update</span> v2_empt_dept
<span class="token keyword">set</span> name <span class="token operator">=</span><span class="token string">&#39;Hello,word&#39;</span>
<span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">&#39;Nancy,Greenberg&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> v2_empt_dept<span class="token punctuation">;</span>

<span class="token comment">-- 删除失败</span>

<span class="token keyword">delete</span>
<span class="token keyword">from</span> v2_empt_dept
<span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">&#39;Nancy,Greenberg&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">delete</span>
<span class="token keyword">from</span> v2_empt_dept
<span class="token keyword">where</span> department_name <span class="token operator">=</span> <span class="token string">&#39;Executive&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">delete</span>
<span class="token keyword">from</span> v2_empt_dept
<span class="token keyword">where</span> department_id <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="存储过程与函数" tabindex="-1"><a class="header-anchor" href="#存储过程与函数" aria-hidden="true">#</a> 存储过程与函数</h2><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- 创建存储过程</span>

<span class="token keyword">delimiter</span> $
<span class="token keyword">create</span> <span class="token keyword">procedure</span> select_all_data<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
    <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> employees<span class="token punctuation">;</span>
<span class="token keyword">end</span> $
<span class="token keyword">delimiter</span> <span class="token punctuation">;</span>

<span class="token keyword">select</span> <span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 调用存储过程</span>

<span class="token keyword">call</span> select_all_data<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询employees最高薪资</span>

<span class="token keyword">delimiter</span> $
<span class="token keyword">create</span> <span class="token keyword">procedure</span> select_emp_avg_salary<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
    <span class="token keyword">select</span> <span class="token function">max</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">from</span> employees<span class="token punctuation">;</span>
<span class="token keyword">end</span> $
<span class="token keyword">delimiter</span> <span class="token punctuation">;</span>

<span class="token keyword">call</span> select_emp_avg_salary<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 带out参数</span>

<span class="token keyword">delimiter</span> $
<span class="token keyword">create</span> <span class="token keyword">procedure</span> select_min_salary<span class="token punctuation">(</span><span class="token keyword">out</span> ms <span class="token keyword">double</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
    <span class="token keyword">select</span> <span class="token function">min</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">into</span> ms <span class="token keyword">from</span> employees<span class="token punctuation">;</span>
<span class="token keyword">end</span> $
<span class="token keyword">delimiter</span> <span class="token punctuation">;</span>
<span class="token keyword">call</span> select_min_salary<span class="token punctuation">(</span><span class="token variable">@ms</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token variable">@ms</span><span class="token punctuation">;</span>

<span class="token comment">-- 带in参数,</span>

<span class="token comment">-- 查询某个员工的的工资</span>

<span class="token keyword">delimiter</span> $
<span class="token keyword">create</span> <span class="token keyword">procedure</span> select_salary_by_name<span class="token punctuation">(</span><span class="token operator">in</span> name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
    <span class="token keyword">select</span> salary <span class="token keyword">from</span> employees <span class="token keyword">where</span> last_name <span class="token operator">=</span> name<span class="token punctuation">;</span>
<span class="token keyword">end</span> $
<span class="token keyword">delimiter</span> <span class="token punctuation">;</span>
<span class="token keyword">call</span> select_salary_by_name<span class="token punctuation">(</span><span class="token string">&#39;King&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 带in和out</span>

<span class="token comment">-- 查询employees中某个员工的工资,用out参数输出工资</span>

<span class="token keyword">delimiter</span> $
<span class="token keyword">create</span> <span class="token keyword">procedure</span> select_salary_by_id<span class="token punctuation">(</span><span class="token operator">in</span> id <span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">out</span> sal <span class="token keyword">double</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
    <span class="token keyword">select</span> salary <span class="token keyword">into</span> sal <span class="token keyword">from</span> employees <span class="token keyword">where</span> employee_id <span class="token operator">=</span> id<span class="token punctuation">;</span>
<span class="token keyword">end</span> $
<span class="token keyword">delimiter</span> <span class="token punctuation">;</span>
<span class="token keyword">desc</span> employees<span class="token punctuation">;</span>
<span class="token keyword">call</span> select_salary_by_id<span class="token punctuation">(</span><span class="token number">103</span><span class="token punctuation">,</span> <span class="token variable">@sal</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token variable">@sal</span> <span class="token keyword">as</span> sal<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="into" tabindex="-1"><a class="header-anchor" href="#into" aria-hidden="true">#</a> into</h4><h4 id="练习-11" tabindex="-1"><a class="header-anchor" href="#练习-11" aria-hidden="true">#</a> 练习</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">delimiter</span> $
<span class="token keyword">create</span> <span class="token keyword">procedure</span> select_manager_name_by_employee_name<span class="token punctuation">(</span><span class="token keyword">inout</span> employee_name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
    <span class="token keyword">select</span> last_name
    <span class="token keyword">into</span> employee_name
    <span class="token keyword">from</span> employees
    <span class="token keyword">where</span> employee_id <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> manager_id
                         <span class="token keyword">from</span> employees
                         <span class="token keyword">where</span> last_name <span class="token operator">=</span> employee_name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span> $
<span class="token keyword">delimiter</span> <span class="token punctuation">;</span>
<span class="token keyword">set</span> <span class="token variable">@employee_name</span> <span class="token operator">=</span> <span class="token string">&#39;Kochhar&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">call</span> select_manager_name_by_employee_name<span class="token punctuation">(</span><span class="token variable">@employee_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token variable">@employee_name</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="存储函数" tabindex="-1"><a class="header-anchor" href="#存储函数" aria-hidden="true">#</a> 存储函数</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- 练习,创建存储函数,参数为空,查询Abel的email</span>

<span class="token keyword">delimiter</span> $
<span class="token keyword">create</span> <span class="token keyword">function</span> select_email<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">returns</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span>
    <span class="token keyword">deterministic</span>
    <span class="token keyword">contains</span> <span class="token keyword">sql</span>
    <span class="token keyword">reads</span> <span class="token keyword">sql</span> <span class="token keyword">data</span>
<span class="token keyword">begin</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">select</span> email <span class="token keyword">from</span> employees <span class="token keyword">where</span> last_name <span class="token operator">=</span> <span class="token string">&#39;Abel&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span> $
<span class="token keyword">delimiter</span> <span class="token punctuation">;</span>
<span class="token keyword">select</span> select_email<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 练习,通过employee_id查询email</span>

<span class="token keyword">delimiter</span> $
<span class="token keyword">create</span> <span class="token keyword">function</span> select_email_by_id<span class="token punctuation">(</span>id <span class="token keyword">int</span><span class="token punctuation">)</span>
    <span class="token keyword">returns</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span>
    <span class="token keyword">reads</span> <span class="token keyword">sql</span> <span class="token keyword">data</span>
<span class="token keyword">begin</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">select</span> email <span class="token keyword">from</span> employees <span class="token keyword">where</span> id <span class="token operator">=</span> employee_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span> $
<span class="token keyword">delimiter</span> <span class="token punctuation">;</span>

<span class="token keyword">select</span> select_email_by_id<span class="token punctuation">(</span><span class="token number">103</span><span class="token punctuation">)</span> <span class="token keyword">as</span> email<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="系统变量和会话变量" tabindex="-1"><a class="header-anchor" href="#系统变量和会话变量" aria-hidden="true">#</a> 系统变量和会话变量</h2><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">show</span> <span class="token keyword">global</span> variables<span class="token punctuation">;</span>
<span class="token keyword">show</span> <span class="token keyword">session</span> variables<span class="token punctuation">;</span>

<span class="token keyword">select</span> @<span class="token variable">@global.admin_port</span><span class="token punctuation">;</span>

<span class="token keyword">select</span> @<span class="token variable">@session.binlog_row_image</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="自定义变量" tabindex="-1"><a class="header-anchor" href="#自定义变量" aria-hidden="true">#</a> 自定义变量</h2><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment"># 方式一</span>
<span class="token keyword">set</span> <span class="token variable">@m1</span> <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">set</span> <span class="token variable">@m2</span> :<span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
<span class="token keyword">set</span> <span class="token variable">@m3</span> :<span class="token operator">=</span> <span class="token variable">@m1</span> <span class="token operator">+</span> <span class="token variable">@m2</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token variable">@m3</span><span class="token punctuation">;</span>
<span class="token comment"># 方式2</span>
<span class="token keyword">set</span> <span class="token variable">@sum_salary</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token variable">@sum_salary</span> :<span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
<span class="token keyword">from</span> employees<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token variable">@sum_salary</span><span class="token punctuation">;</span>

<span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
<span class="token keyword">into</span> <span class="token variable">@avg_salary</span>
<span class="token keyword">from</span> employees<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token variable">@avg_salary</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="局部变量" tabindex="-1"><a class="header-anchor" href="#局部变量" aria-hidden="true">#</a> 局部变量</h2><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">delimiter</span> $
<span class="token keyword">create</span> <span class="token keyword">procedure</span> select_emp_info<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
    <span class="token keyword">declare</span> a <span class="token keyword">int</span> <span class="token keyword">default</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">declare</span> b <span class="token keyword">int</span><span class="token punctuation">;</span>
    <span class="token keyword">declare</span> emp_name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">select</span> last_name <span class="token keyword">into</span> emp_name <span class="token keyword">from</span> employees <span class="token keyword">where</span> employee_id <span class="token operator">=</span> <span class="token number">101</span><span class="token punctuation">;</span>
    <span class="token keyword">set</span> a <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">set</span> b <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
    <span class="token keyword">set</span> b <span class="token operator">=</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
    <span class="token keyword">select</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> emp_name<span class="token punctuation">;</span>
<span class="token keyword">end</span> $
<span class="token keyword">delimiter</span> <span class="token punctuation">;</span>
<span class="token keyword">call</span> select_emp_info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="流程控制" tabindex="-1"><a class="header-anchor" href="#流程控制" aria-hidden="true">#</a> 流程控制</h2><h3 id="分支结构之if" tabindex="-1"><a class="header-anchor" href="#分支结构之if" aria-hidden="true">#</a> 分支结构之if</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">delimiter</span> $
<span class="token keyword">create</span> <span class="token keyword">procedure</span> select_salary_info<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
    <span class="token keyword">declare</span> emp_name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> emp_name <span class="token operator">is</span> <span class="token boolean">null</span>
    <span class="token keyword">then</span>
        <span class="token keyword">select</span> <span class="token string">&#39;emp_name is null&#39;</span><span class="token punctuation">;</span>
    <span class="token keyword">end</span> <span class="token keyword">if</span><span class="token punctuation">;</span>
<span class="token keyword">end</span> $
<span class="token keyword">delimiter</span> <span class="token punctuation">;</span>
<span class="token keyword">call</span> select_salary_info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="练习1" tabindex="-1"><a class="header-anchor" href="#练习1" aria-hidden="true">#</a> 练习1</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">delimiter</span> $
<span class="token keyword">create</span> <span class="token keyword">procedure</span> test_if01<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
    <span class="token keyword">declare</span> age <span class="token keyword">int</span> <span class="token keyword">default</span> <span class="token number">20</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> age <span class="token operator">&lt;</span> <span class="token number">6</span>
    <span class="token keyword">then</span>
        <span class="token keyword">select</span> <span class="token string">&#39;婴儿&#39;</span><span class="token punctuation">;</span>
    <span class="token keyword">elseif</span> age <span class="token operator">&gt;=</span> <span class="token number">6</span> <span class="token operator">and</span> age <span class="token operator">&lt;</span> <span class="token number">12</span>
    <span class="token keyword">then</span>
        <span class="token keyword">select</span> <span class="token string">&#39;儿童&#39;</span><span class="token punctuation">;</span>
    <span class="token keyword">elseif</span> age <span class="token operator">&gt;</span> <span class="token number">12</span> <span class="token operator">and</span> age <span class="token operator">&lt;</span> <span class="token number">18</span>
    <span class="token keyword">then</span>
        <span class="token keyword">select</span> <span class="token string">&#39;少年&#39;</span><span class="token punctuation">;</span>
    <span class="token keyword">elseif</span> age <span class="token operator">&gt;</span> <span class="token number">18</span> <span class="token operator">and</span> age <span class="token operator">&lt;</span> <span class="token number">60</span>
    <span class="token keyword">then</span>
        <span class="token keyword">select</span> <span class="token string">&#39;中年&#39;</span><span class="token punctuation">;</span>
    <span class="token keyword">elseif</span> age <span class="token operator">&gt;</span> <span class="token number">60</span>
    <span class="token keyword">then</span>
        <span class="token keyword">select</span> <span class="token string">&#39;老年&#39;</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span>
        <span class="token keyword">select</span> <span class="token string">&#39;其他&#39;</span><span class="token punctuation">;</span>
    <span class="token keyword">end</span> <span class="token keyword">if</span><span class="token punctuation">;</span>

<span class="token keyword">end</span> $
<span class="token keyword">delimiter</span> <span class="token punctuation">;</span>

<span class="token keyword">call</span> test_if01<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="游标使用" tabindex="-1"><a class="header-anchor" href="#游标使用" aria-hidden="true">#</a> 游标使用</h2><h3 id="申明-打开-使用-关闭" tabindex="-1"><a class="header-anchor" href="#申明-打开-使用-关闭" aria-hidden="true">#</a> 申明,打开,使用,关闭</h3><blockquote><p>创建存储过程“get_count_by_limit_total_salary()”，声明IN参数 limit_total_salary，DOUBLE类型；声明</p><p>OUT参数total_count，INT类型。函数的功能可以实现累加薪资最高的几个员工的薪资值，直到薪资总和</p><p>达到limit_total_salary参数的值，返回累加的人数给total_count。</p></blockquote><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">delimiter</span> $
<span class="token keyword">create</span> <span class="token keyword">procedure</span> get_count_by_limit_total_salary<span class="token punctuation">(</span><span class="token operator">in</span> limit_total_salary <span class="token keyword">double</span><span class="token punctuation">,</span> <span class="token keyword">out</span> total_count <span class="token keyword">int</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
    <span class="token comment">#  申明局部变量</span>
    <span class="token keyword">declare</span> sum_salary <span class="token keyword">double</span> <span class="token keyword">default</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment"># 记录累加的总工资</span>
    <span class="token keyword">declare</span> cursor_salary <span class="token keyword">double</span> <span class="token keyword">default</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment"># 每次游标的工资</span>
    <span class="token keyword">declare</span> emp_count <span class="token keyword">int</span> <span class="token keyword">default</span> <span class="token number">0</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="申明游标" tabindex="-1"><a class="header-anchor" href="#申明游标" aria-hidden="true">#</a> 申明游标</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">declare</span> emp_salary_cursor <span class="token keyword">cursor</span> <span class="token keyword">for</span> <span class="token keyword">select</span> salary <span class="token keyword">from</span> employees <span class="token keyword">order</span> <span class="token keyword">by</span> salary <span class="token keyword">desc</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="打开游标" tabindex="-1"><a class="header-anchor" href="#打开游标" aria-hidden="true">#</a> 打开游标</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">open</span> emp_salary_cursor<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="获取游标数据" tabindex="-1"><a class="header-anchor" href="#获取游标数据" aria-hidden="true">#</a> 获取游标数据</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">repeat</span>
    <span class="token keyword">fetch</span> emp_salary_cursor <span class="token keyword">into</span> cursor_salary<span class="token punctuation">;</span>
    <span class="token keyword">set</span> sum_salary <span class="token operator">=</span> sum_salary <span class="token operator">+</span> cursor_salary<span class="token punctuation">;</span>
    <span class="token keyword">set</span> emp_count <span class="token operator">=</span> emp_count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
until sum_salary <span class="token operator">&gt;=</span> limit_total_salary <span class="token keyword">end</span> <span class="token keyword">repeat</span><span class="token punctuation">;</span>

<span class="token keyword">set</span> total_count <span class="token operator">=</span> emp_count<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="关闭游标" tabindex="-1"><a class="header-anchor" href="#关闭游标" aria-hidden="true">#</a> 关闭游标</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">close</span> emp_salary_cursor<span class="token punctuation">;</span>
<span class="token keyword">end</span> $
<span class="token keyword">delimiter</span> <span class="token punctuation">;</span>

<span class="token keyword">call</span> get_count_by_limit_total_salary<span class="token punctuation">(</span><span class="token number">100000</span><span class="token punctuation">,</span> <span class="token variable">@total_count</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token variable">@total_count</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="创建触发器" tabindex="-1"><a class="header-anchor" href="#创建触发器" aria-hidden="true">#</a> 创建触发器</h2><blockquote><p>定义触发器“salary_check_trigger”，基于员工表“employees”的INSERT事件，在INSERT之前检查</p><p>将要添加的新员工薪资是否大于他领导的薪资，如果大于领导薪资，则报sqlstate_value为&#39;HY000&#39;的错</p><p>误，从而使得添加失败。</p></blockquote><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">show</span> <span class="token keyword">tables</span><span class="token punctuation">;</span>

<span class="token keyword">delimiter</span> $
<span class="token keyword">create</span> <span class="token keyword">trigger</span> salary_check_trigger
    before <span class="token keyword">insert</span>
    <span class="token keyword">on</span> employees
    <span class="token keyword">for each row</span>
<span class="token keyword">begin</span>
    <span class="token keyword">declare</span> manager_salary <span class="token keyword">double</span><span class="token punctuation">;</span>
    <span class="token keyword">select</span> salary <span class="token keyword">into</span> manager_salary <span class="token keyword">from</span> employees <span class="token keyword">where</span> employee_id <span class="token operator">=</span> NEW<span class="token punctuation">.</span>manager_id<span class="token punctuation">;</span>
    <span class="token keyword">if</span> NEW<span class="token punctuation">.</span>salary <span class="token operator">&gt;</span> manager_salary <span class="token keyword">then</span>
        signal sqlstate <span class="token string">&#39;HY000&#39;</span> <span class="token keyword">set</span> MESSAGE_TEXT <span class="token operator">=</span> <span class="token string">&#39;薪资高于领导薪资错误&#39;</span><span class="token punctuation">;</span>
    <span class="token keyword">end</span> <span class="token keyword">if</span><span class="token punctuation">;</span>
<span class="token keyword">end</span> $
<span class="token keyword">delimiter</span> <span class="token punctuation">;</span>

<span class="token keyword">show</span> triggers <span class="token punctuation">;</span>
<span class="token keyword">desc</span> employees<span class="token punctuation">;</span>

<span class="token keyword">insert</span> <span class="token keyword">into</span> employees<span class="token punctuation">(</span>employee_id<span class="token punctuation">,</span> last_name<span class="token punctuation">,</span> salary<span class="token punctuation">,</span>
                      manager_id<span class="token punctuation">,</span>email<span class="token punctuation">,</span>hire_date<span class="token punctuation">,</span>job_id<span class="token punctuation">)</span>
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">207</span><span class="token punctuation">,</span> <span class="token string">&#39;Jerry&#39;</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">,</span> <span class="token number">147</span><span class="token punctuation">,</span><span class="token string">&#39;haha@163.com&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;2017-01-01&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;IT_PROG&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> employees<span class="token punctuation">(</span>employee_id<span class="token punctuation">,</span> last_name<span class="token punctuation">,</span> salary<span class="token punctuation">,</span>
                      manager_id<span class="token punctuation">,</span>email<span class="token punctuation">,</span>hire_date<span class="token punctuation">,</span>job_id<span class="token punctuation">)</span>
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">207</span><span class="token punctuation">,</span> <span class="token string">&#39;Tom&#39;</span><span class="token punctuation">,</span> <span class="token number">20000</span><span class="token punctuation">,</span> <span class="token number">147</span><span class="token punctuation">,</span><span class="token string">&#39;haha@163.com&#39;</span><span class="token punctuation">,</span>curdate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">&#39;IT_PROG&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> employees<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,465),o=[t];function l(c,i){return n(),a("div",null,o)}const r=s(p,[["render",l],["__file","MySQL学习记录.html.vue"]]);export{r as default};
